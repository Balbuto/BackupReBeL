#!/usr/bin/env bash
a="/etc/bakup-rebel";b="$a/.backup_rebel_config";c="$a/.backup_rebel_projects";d="$a/.backup_rebel_cron"
e="$a/.backup_rebel_schedule";f="$a/.backup_rebel_passwords";g="$a/.backup_rebel_telegram"
h="$a/.backup_rebel_email";i="$a/.backup_rebel_env_cache";j="/var/backup-rebel";k="$j/backup.log";l=7
m="$a/.backup_rebel_projects_temp";n='\033[0;31m';o='\033[0;32m';p='\033[1;33m';q='\033[0;34m'
r='\033[0;35m';s='\033[0;36m';t='\033[1;37m';u='\033[0;33m';v='\033[0;35m';w='\033[0;36m';x='\033[0m'
y="üîê";z="üîì";A="üìÑ";B="üë§";C="üîç";D="üóÑÔ∏è";E="üîë";F="üì¶";G="‚úÖ";H="‚ö†Ô∏è";I="‚ùå";J="üìÅ";K="‚è∞";L="üíæ"
M="üìà";N="üì•";O="üì§";P="üóëÔ∏è";Q="üìÇ";R="‚öôÔ∏è";S="‚ûï";T="‚ûñ";U="üìÖ";V="‚è≤Ô∏è";W="üìß";X="üìé";Y="false";Z=""
aa="";ab="";ac="true";ad=50;ae="true";af="true";ag="true";ah="HTML";ai="combined";aj="false"
ak="smtp.gmail.com";al="587";am="";an="";ao="";ap="";aq="[Backup-Rebel]";ar="true";as="true"
at=25;au="true";av="true";aw="true";ax(){ local A="$1";local B="$2";local C=$(date '+%Y-%m-%d %H:%M:%S')
local D="$x";case "$A" in "INFO") D="$q";;"SUCCESS") D="$o";;"WARNING") D="$p";;"ERROR") D="$n";;
"CRON") D="$r";;"SCHEDULE") D="$v";;"PROJECT") D="$s";;"DB") D="$t";;"TELEGRAM") D="$w";;"EMAIL") D="$u";;
"RESTORE") D="$v";;"PASS") D="$u";;"ENV") D="$v";;"DEBUG") D="$r";;esac
echo -e "${D}[$C] [$A]${x} $B" >&2;echo "[$C] [$A] $B" >> "$k";}
ay(){ if [ "$(id -u)" -ne 0 ];then echo -e "${n}–û–®–ò–ë–ö–ê: –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω –æ—Ç –∏–º–µ–Ω–∏ root!${x}";echo "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: sudo $0";exit 1;fi;}
az(){ local A=();for B in docker tar gzip psql crontab grep openssl curl bc;do if ! command -v $B >/dev/null 2>&1;then A+=("$B");fi;done
if ! command -v jq >/dev/null 2>&1;then ax "WARNING" "jq –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ü–æ–ø—ã—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏...";if command -v apt-get >/dev/null 2>&1;then
apt-get update && apt-get install -y jq 2>/dev/null || true;elif command -v yum >/dev/null 2>&1;then yum install -y jq 2>/dev/null || true
elif command -v dnf >/dev/null 2>&1;then dnf install -y jq 2>/dev/null || true;fi;if ! command -v jq >/dev/null 2>&1;then A+=("jq")
ax "WARNING" "–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å jq. –≠–∫—Å–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ JSON –±—É–¥–µ—Ç —É–ø—Ä–æ—â–µ–Ω.";else ax "SUCCESS" "jq —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω";fi;fi
if ! command -v sendmail >/dev/null 2>&1;then ax "WARNING" "sendmail –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ü–æ–ø—ã—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏...";if command -v apt-get >/dev/null 2>&1;then
apt-get update && apt-get install -y sendmail 2>/dev/null || true;elif command -v yum >/dev/null 2>&1;then yum install -y sendmail 2>/dev/null || true;fi;fi
if [ ${#A[@]} -gt 0 ];then ax "ERROR" "–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–∞–Ω–¥—ã: ${A[*]}";ax "INFO" "–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –ø–∞–∫–µ—Ç—ã:"
if command -v apt-get >/dev/null 2>&1;then ax "INFO" "apt-get install ${A[*]}";elif command -v yum >/dev/null 2>&1;then ax "INFO" "yum install ${A[*]}";fi
exit 1;fi;if ! docker info >/dev/null 2>&1;then ax "ERROR" "Docker –Ω–µ –∑–∞–ø—É—â–µ–Ω –∏–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞";exit 1;fi;}
aA(){ local A="$1";local B=0;if [ ! -f "$A" ];then echo "0";return 1;fi;if B=$(stat -c%s "$A" 2>/dev/null);then echo "$B";return 0;fi
if B=$(du -b "$A" 2>/dev/null | awk '{print $1}');then echo "$B";return 0;fi;if B=$(wc -c < "$A" 2>/dev/null);then echo "$B";return 0;fi
if B=$(ls -l "$A" 2>/dev/null | awk '{print $5}');then echo "$B";return 0;fi;echo "0";return 1;}
aB(){ local A="$1";if ! [[ "$A" =~ ^[0-9]+$ ]] || [ "$A" -eq 0 ];then echo "0B";return;fi;local B=("B" "KB" "MB" "GB" "TB");local C=0
while [ "$A" -ge 1024 ] && [ "$C" -lt 4 ];do A=$((A / 1024));C=$((C + 1));done;echo "${A}${B[$C]}";}
aC(){ mkdir -p "$j" "$a" "$(dirname "$k")" "$m" 2>/dev/null || { ax "ERROR" "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏";exit 1;}
chmod 700 "$a";chmod 755 "$j";chmod 644 "$k" 2>/dev/null || true;}
aD(){ local A="$1";if [ -z "$A" ];then echo "";return;fi;echo "$A" | openssl enc -aes-256-cbc -base64 -A -salt -pass pass:backup_script 2>/dev/null || echo "";}
aE(){ local A="$1";if [ -z "$A" ];then echo "";return;fi;echo "$A" | openssl enc -aes-256-cbc -d -base64 -A -pass pass:backup_script 2>/dev/null || echo "";}
aF(){ local A="$1";local B="$2";local C="$3";echo "dbpass:${A}:${B}:${C}";}
aG(){ local A="$1";local B="$2";echo "env:${A}:${B}";}
aH(){ local A="$1";if [ -z "$A" ] || ! echo "$A" | grep -q '^postgres://';then echo "";return;fi;local B=$(echo "$A" | sed 's|^postgres://||')
if echo "$B" | grep -q '^\([^:]*\):\([^@]*\)@\([^/]*\)/\(.*\)$';then local C=$(echo "$B" | sed 's|^\([^:]*\):\([^@]*\)@\([^/]*\)/\(.*\)$|\1|')
local D=$(echo "$B" | sed 's|^\([^:]*\):\([^@]*\)@\([^/]*\)/\(.*\)$|\2|');echo "$D";return;fi;echo "";}
aI(){ local A="$1";if [ ! -f "$A" ];then echo "";return;fi;local B="";while IFS= read -r C || [ -n "$C" ];do
if [ -z "$C" ] || echo "$C" | grep -q '^[[:space:]]*#';then continue;fi;C=$(echo "$C" | sed 's/^[[:space:]]*//;s/[[:space:]]*$//')
if echo "$C" | grep -qi '^POSTGRES_USER[[:space:]]*=';then B=$(echo "$C" | cut -d'=' -f2- | sed "s/^['\" ]*//;s/['\" ]*$//");break
elif echo "$C" | grep -qi '^DATABASE_USER[[:space:]]*=';then B=$(echo "$C" | cut -d'=' -f2- | sed "s/^['\" ]*//;s/['\" ]*$//");break
elif echo "$C" | grep -qi '^DB_USER[[:space:]]*=';then B=$(echo "$C" | cut -d'=' -f2- | sed "s/^['\" ]*//;s/['\" ]*$//");break
elif echo "$C" | grep -qi '^DB_USERNAME[[:space:]]*=';then B=$(echo "$C" | cut -d'=' -f2- | sed "s/^['\" ]*//;s/['\" ]*$//");break;fi;done < "$A"
[ -z "$B" ] && B="postgres";echo "$B";}
aJ(){ local A="$1";if [ ! -f "$A" ];then echo "";return;fi;local B="";while IFS= read -r C || [ -n "$C" ];do
if [ -z "$C" ] || echo "$C" | grep -q '^[[:space:]]*#';then continue;fi;C=$(echo "$C" | sed 's/^[[:space:]]*//;s/[[:space:]]*$//')
if echo "$C" | grep -qi '^POSTGRES_DB[[:space:]]*=';then B=$(echo "$C" | cut -d'=' -f2- | sed "s/^['\" ]*//;s/['\" ]*$//");break
elif echo "$C" | grep -qi '^DATABASE_NAME[[:space:]]*=';then B=$(echo "$C" | cut -d'=' -f2- | sed "s/^['\" ]*//;s/['\" ]*$//");break
elif echo "$C" | grep -qi '^DB_NAME[[:space:]]*=';then B=$(echo "$C" | cut -d'=' -f2- | sed "s/^['\" ]*//;s/['\" ]*$//");break
elif echo "$C" | grep -qi '^DB_DATABASE[[:space:]]*=';then B=$(echo "$C" | cut -d'=' -f2- | sed "s/^['\" ]*//;s/['\" ]*$//");break;fi;done < "$A"
[ -z "$B" ] && B="postgres";echo "$B";}
aK(){ local A="$1";if [ ! -f "$A" ];then echo "";return;fi;local B="";while IFS= read -r C || [ -n "$C" ];do
if [ -z "$C" ] || echo "$C" | grep -q '^[[:space:]]*#';then continue;fi;C=$(echo "$C" | xargs);if echo "$C" | grep -qi '^POSTGRES_PASSWORD[[:space:]]*=';then
B=$(echo "$C" | cut -d'=' -f2- | sed "s/^['\"]//;s/['\"]$//" | xargs);break;elif echo "$C" | grep -qi '^DATABASE_PASSWORD[[:space:]]*=';then
B=$(echo "$C" | cut -d'=' -f2- | sed "s/^['\"]//;s/['\"]$//" | xargs);break;elif echo "$C" | grep -qi '^DB_PASSWORD[[:space:]]*=';then
B=$(echo "$C" | cut -d'=' -f2- | sed "s/^['\"]//;s/['\"]$//" | xargs);break;elif echo "$C" | grep -qi '^DB_PASS[[:space:]]*=';then
B=$(echo "$C" | cut -d'=' -f2- | sed "s/^['\"]//;s/['\"]$//" | xargs);break;elif echo "$C" | grep -qi '^DATABASE_URL[[:space:]]*=';then
local D=$(echo "$C" | cut -d'=' -f2- | sed "s/^['\"]//;s/['\"]$//" | xargs);B=$(aH "$D");if [ -n "$B" ];then break;fi;fi;done < "$A";echo "$B";}
aL(){ local A="$1";ax "ENV" "–ü–æ–∏—Å–∫ .env —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ $A";local B=$(docker inspect "$A" --format '{{range .Mounts}}{{.Source}}:{{.Destination}} {{end}}' 2>/dev/null)
local C=$(docker inspect "$A" --format '{{.Config.WorkingDir}}' 2>/dev/null);local D=$(docker inspect "$A" --format '{{index .Config.Labels "com.docker.compose.project"}}' 2>/dev/null)
local E=$(docker inspect "$A" --format '{{index .Config.Labels "com.docker.compose.project.working_dir"}}' 2>/dev/null);local F=();if [ -n "$C" ] && [ "$C" != "/" ];then F+=("$C");fi
for G in $B;do local H=$(echo "$G" | cut -d: -f1);if [ -d "$H" ];then F+=("$H");local I=$(dirname "$H");while [ "$I" != "/" ] && [ ${#F[@]} -lt 10 ];do F+=("$I");I=$(dirname "$I");done;fi;done
if [ -n "$E" ] && [ -d "$E" ];then F+=("$E");fi;F+=("/opt/remnawave" "/var/www" "/opt/" "/opt/remnanode" "/opt/remnashop" "/home/app");local J=()
for K in "${F[@]}";do if [[ ! " ${J[@]} " =~ " ${K} " ]] && [ -n "$K" ];then J+=("$K");fi;done;for K in "${J[@]}";do if [ -f "$K/.env" ];then echo "$K/.env";return 0;fi
if docker exec "$A" test -f "$K/.env" 2>/dev/null;then echo "container:$K/.env";return 0;fi;done;echo "";return 1;}
aM(){ local A="$1";local B="$2";local C="$3";local D=$(aL "$A");if [ -n "$D" ];then local E="";if [[ "$D" == container:* ]];then local F="${D#container:}";local G=$(mktemp)
if docker cp "$A:$F" "$G" 2>/dev/null;then E=$(aK "$G");rm -f "$G";fi;else E=$(aK "$D");fi;if [ -n "$E" ];then echo "$E";return;fi;fi
if [ -f "./.env" ];then local E=$(aK "./.env");if [ -n "$E" ];then echo "$E";return;fi;fi;if [ -f "/root/.env" ];then local E=$(aK "/root/.env");if [ -n "$E" ];then echo "$E";return;fi;fi;echo "";}
aN(){ { echo "EMAIL_ENABLED=\"$aj\"";echo "EMAIL_SMTP_SERVER=\"$ak\"";echo "EMAIL_SMTP_PORT=\"$al\"";echo "EMAIL_SMTP_USER=\"$am\""
echo "EMAIL_SMTP_PASSWORD=\"$an\"";echo "EMAIL_FROM=\"$ao\"";echo "EMAIL_TO=\"$ap\"";echo "EMAIL_SUBJECT_PREFIX=\"$aq\""
echo "EMAIL_SEND_REPORTS=\"$ar\"";echo "EMAIL_SEND_FILES=\"$as\"";echo "EMAIL_MAX_FILE_SIZE=\"$at\"";echo "EMAIL_COMPRESS_ATTACHMENTS=\"$au\""
echo "EMAIL_NOTIFY_ON_SUCCESS=\"$av\"";echo "EMAIL_NOTIFY_ON_FAILURE=\"$aw\"";} > "$h";chmod 600 "$h";ax "EMAIL" "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Email —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã";}
aO(){ if [ -f "$h" ];then ax "EMAIL" "–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Email";. "$h" 2>/dev/null || ax "ERROR" "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Email";fi;}
aP(){ if [ "$aj" != "true" ];then return 1;fi;if [ -z "$am" ] || [ -z "$an" ] || [ -z "$ao" ] || [ -z "$ap" ];then ax "WARNING" "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Email –Ω–µ–ø–æ–ª–Ω—ã–µ";return 1;fi;return 0;}
aQ(){ local A="$1";local B="$2";local C="$3";local D=("${@:4}");ax "DEBUG" "–û—Ç–ø—Ä–∞–≤–∫–∞ email —á–µ—Ä–µ–∑ sendmail –Ω–∞ –∞–¥—Ä–µ—Å: $A";local E=$(mktemp);local F="boundary_$(date +%s)_${RANDOM}"
{ echo "To: $A";echo "From: $ao";echo "Subject: $B";echo "MIME-Version: 1.0";echo "Content-Type: multipart/mixed; boundary=\"$F\"";echo "";echo "--$F"
echo "Content-Type: text/html; charset=UTF-8";echo "Content-Transfer-Encoding: 8bit";echo "";echo "$C";echo "";for G in "${D[@]}";do if [ -f "$G" ];then local H=$(basename "$G")
local I="application/octet-stream";if [[ "$H" == *.txt ]];then I="text/plain";elif [[ "$H" == *.html ]];then I="text/html"
elif [[ "$H" == *.jpg ]] || [[ "$H" == *.jpeg ]];then I="image/jpeg";elif [[ "$H" == *.png ]];then I="image/png"
elif [[ "$H" == *.pdf ]];then I="application/pdf";elif [[ "$H" == *.tar.gz ]] || [[ "$H" == *.tgz ]];then I="application/gzip";fi
echo "--$F";echo "Content-Type: $I; name=\"$H\"";echo "Content-Transfer-Encoding: base64";echo "Content-Disposition: attachment; filename=\"$H\"";echo "";base64 "$G";echo "";fi;done
echo "--$F--";} > "$E";if sendmail -t < "$E" 2>/dev/null;then ax "EMAIL" "Email –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ $A";rm -f "$E";return 0;else ax "ERROR" "–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ email –Ω–∞ $A"
rm -f "$E";return 1;fi;}
aR(){ local A="$1";local B="$2";local C="$3";local D=("${@:4}");ax "DEBUG" "–û—Ç–ø—Ä–∞–≤–∫–∞ email —á–µ—Ä–µ–∑ curl (SMTP) –Ω–∞ –∞–¥—Ä–µ—Å: $A";local E=$(mktemp);local F="boundary_$(date +%s)_${RANDOM}"
{ echo "To: $A";echo "From: $ao";echo "Subject: $B";echo "MIME-Version: 1.0";echo "Content-Type: multipart/mixed; boundary=\"$F\"";echo "";echo "--$F"
echo "Content-Type: text/html; charset=UTF-8";echo "Content-Transfer-Encoding: 8bit";echo "";echo "$C";echo "";for G in "${D[@]}";do if [ -f "$G" ];then local H=$(basename "$G")
local I="application/octet-stream";if [[ "$H" == *.txt ]];then I="text/plain";elif [[ "$H" == *.html ]];then I="text/html"
elif [[ "$H" == *.jpg ]] || [[ "$H" == *.jpeg ]];then I="image/jpeg";elif [[ "$H" == *.png ]];then I="image/png"
elif [[ "$H" == *.pdf ]];then I="application/pdf";elif [[ "$H" == *.tar.gz ]] || [[ "$H" == *.tgz ]];then I="application/gzip";fi
echo "--$F";echo "Content-Type: $I; name=\"$H\"";echo "Content-Transfer-Encoding: base64";echo "Content-Disposition: attachment; filename=\"$H\"";echo "";base64 "$G";echo "";fi;done
echo "--$F--";} > "$E";local J="curl --silent --url \"smtp://$ak:$al\" --ssl-reqd --mail-from \"$ao\" --mail-rcpt \"$A\" --upload-file \"$E\" --user \"$am:$an\""
if eval "$J" 2>/dev/null;then ax "EMAIL" "Email –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —á–µ—Ä–µ–∑ SMTP –Ω–∞ $A";rm -f "$E";return 0;else ax "ERROR" "–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ email —á–µ—Ä–µ–∑ SMTP"
if command -v sendmail >/dev/null 2>&1;then ax "INFO" "–ü—Ä–æ–±—É–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ sendmail...";aQ "$A" "$B" "$C" "${D[@]}";else rm -f "$E";return 1;fi;fi;}
aS(){ local A="$1";local B="$2";local C="$3";local D=("${@:4}");if [ "$aj" != "true" ];then ax "DEBUG" "Email –æ—Ç–∫–ª—é—á–µ–Ω";return 0;fi;if ! aP;then ax "DEBUG" "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Email –Ω–µ–ø–æ–ª–Ω—ã–µ –∏–ª–∏ –æ—Ç–∫–ª—é—á–µ–Ω—ã";return 1;fi
local E=0;local F=$((at * 1024 * 1024));local G=();for H in "${D[@]}";do if [ -f "$H" ];then local I=$(aA "$H");E=$((E + I));if [ "$I" -gt "$F" ] 2>/dev/null;then ax "WARNING" "–§–∞–π–ª $H —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π ($(aB "$I") > $(aB "$F"))"
else G+=("$H");fi;fi;done;if [ "$au" = "true" ] && [ $E -gt $F ] 2>/dev/null;then ax "INFO" "–°–æ–∑–¥–∞–Ω–∏–µ —Å–∂–∞—Ç–æ–≥–æ –∞—Ä—Ö–∏–≤–∞ –≤–ª–æ–∂–µ–Ω–∏–π...";local J="/tmp/email_attachments_$(date +%s).tar.gz"
tar -czf "$J" "${G[@]}" 2>/dev/null;if [ -f "$J" ];then G=("$J");local K=$(aA "$J");ax "INFO" "–ê—Ä—Ö–∏–≤ —Å–æ–∑–¥–∞–Ω: $(aB "$K")";fi;fi;local L=false
if command -v curl >/dev/null 2>&1 && [ -n "$ak" ];then ax "EMAIL" "–ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ—Ä–µ–∑ SMTP (curl)";if aR "$A" "$B" "$C" "${G[@]}";then L=true;fi;fi
if [ "$L" = false ] && command -v sendmail >/dev/null 2>&1;then ax "EMAIL" "–ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —á–µ—Ä–µ–∑ sendmail";if aQ "$A" "$B" "$C" "${G[@]}";then L=true;fi;fi
if [ -n "$J" ] && [ -f "$J" ];then rm -f "$J";fi;if [ "$L" = true ];then ax "SUCCESS" "Email —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ $A";return 0;else ax "ERROR" "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å email –Ω–∞ $A";return 1;fi;}
aT(){ local A="$1";local B="$2";local C="$3";local D="$4";local E="$5";if [ "$aj" != "true" ];then return 0;fi;if [ "$C" = true ] && [ "$av" != "true" ];then return 0;fi
if [ "$C" = false ] && [ "$aw" != "true" ];then return 0;fi;if [ "$ar" != "true" ];then return 0;fi;local F=$(hostname 2>/dev/null || echo "unknown");local G=$(date '+%Y-%m-%d %H:%M:%S')
local H="‚úÖ";local I="–£–°–ü–ï–®–ù–û";if [ "$C" = false ];then H="‚ùå";I="–û–®–ò–ë–ö–ê";fi;local J="<!DOCTYPE html><html><head><meta charset=\"UTF-8\"><style>body{font-family:Arial,sans-serif;line-height:1.6;color:#333}
.container{max-width:800px;margin:0 auto;padding:20px}.header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:20px;border-radius:5px;margin-bottom:20px}
.status{padding:10px;border-radius:5px;margin:20px 0;font-weight:bold;text-align:center}.success{background-color:#d4edda;color:#155724;border:1px solid #c3e6cb}
.error{background-color:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.info-box{background-color:#f8f9fa;border:1px solid #e9ecef;border-radius:5px;padding:15px;margin:15px 0}
.info-row{display:flex;margin-bottom:10px}.info-label{font-weight:bold;min-width:150px}.log{background-color:#2d3748;color:#e2e8f0;padding:15px;border-radius:5px;font-family:'Courier New',monospace;font-size:12px;white-space:pre-wrap;overflow-x:auto}
.footer{margin-top:30px;padding-top:20px;border-top:1px solid #e9ecef;color:#6c757d;font-size:12px;text-align:center}.attachments{margin:20px 0}.attachment-item{background-color:#e9ecef;padding:10px;border-radius:5px;margin:5px 0}</style></head><body>
<div class=\"container\"><div class=\"header\"><h1>üìä –û—Ç—á–µ—Ç –æ –±—ç–∫–∞–ø–µ –ø—Ä–æ–µ–∫—Ç–∞</h1><p>Backup Rebel - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</p></div>
<div class=\"status $C\"><h2>${H} ${I}</h2></div><div class=\"info-box\"><h3>üìã –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3><div class=\"info-row\"><div class=\"info-label\">–ü—Ä–æ–µ–∫—Ç:</div><div>${A}</div></div>
<div class=\"info-row\"><div class=\"info-label\">–•–æ—Å—Ç:</div><div>${F}</div></div><div class=\"info-row\"><div class=\"info-label\">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è:</div><div>${G}</div></div>
<div class=\"info-row\"><div class=\"info-label\">–°—Ç–∞—Ç—É—Å:</div><div><strong>${I}</strong></div></div></div><div class=\"info-box\"><h3>üìù –î–µ—Ç–∞–ª–∏</h3><div class=\"info-row\"><div class=\"info-label\">–†–µ–∑—É–ª—å—Ç–∞—Ç:</div><div>${D}</div></div></div>"
if [ -n "$B" ] && [ -f "$B" ] && [ "$as" = "true" ];then local K=$(aA "$B");local L=$(aB "$K");J="${J}<div class=\"info-box\"><h3>üìé –í–ª–æ–∂–µ–Ω–∏—è</h3><div class=\"attachments\"><div class=\"attachment-item\">
üì¶ <strong>$(basename "$B")</strong> (${L})</div></div></div>";fi;if [ -n "$E" ];then J="${J}<div class=\"info-box\"><h3>üìã –õ–æ–≥–∏ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫)</h3><div class=\"log\">${E}</div></div>";fi
J="${J}<div class=\"footer\"><p>–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–º Backup Rebel</p><p>–î–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ${G}</p></div></div></body></html>";local M="${aq} ${I}: ${A} - ${G}"
local N=();if [ -n "$B" ] && [ -f "$B" ] && [ "$as" = "true" ];then N+=("$B");fi;if [ -n "$E" ] && [ "$as" = "true" ];then local O="/tmp/backup_log_$(date +%s).txt"
echo "$E" > "$O";N+=("$O");fi;local P=0;local Q=0;IFS=',' read -ra R <<< "$ap";for S in "${R[@]}";do local T=$(echo "$S" | xargs);if [ -n "$T" ];then if aS "$T" "$M" "$J" "${N[@]}";then P=$((P + 1));else Q=$((Q + 1));fi;fi;done
if [ -n "$O" ] && [ -f "$O" ];then rm -f "$O";fi;ax "EMAIL" "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –æ—Ç—á–µ—Ç–æ–≤: $P, –æ—à–∏–±–æ–∫: $Q";if [ $P -gt 0 ];then return 0;else return 1;fi;}
aU(){ local A="$1";local B="$2";local C="$3";local D="$4";local E=("${@:5}");local F="$6";if [ "$aj" != "true" ] || [ "$ar" != "true" ];then return 0;fi
local G=$(hostname 2>/dev/null || echo "unknown");local H=$(date '+%Y-%m-%d %H:%M:%S');local I="success";local J="‚úÖ";local K="–í–°–ï –ü–†–û–ï–ö–¢–´ –£–°–ü–ï–®–ù–û –ó–ê–ë–≠–ö–ê–ü–õ–ï–ù–´"
if [ $B -gt 0 ];then I="error";J="‚ö†Ô∏è";K="–ù–ï–ö–û–¢–û–†–´–ï –ü–†–û–ï–ö–¢–´ –ù–ï –ó–ê–ë–≠–ö–ê–ü–õ–ï–ù–´";elif [ $A -eq 0 ];then I="warning";J="‚ÑπÔ∏è";K="–ù–ï–¢ –£–°–ü–ï–®–ù–´–• –ë–≠–ö–ê–ü–û–í";fi
local L="<!DOCTYPE html><html><head><meta charset=\"UTF-8\"><style>body{font-family:Arial,sans-serif;line-height:1.6;color:#333}.container{max-width:900px;margin:0 auto;padding:20px}
.header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:25px;border-radius:5px;margin-bottom:25px}.status{padding:15px;border-radius:5px;margin:25px 0;font-weight:bold;text-align:center;font-size:18px}
.success{background-color:#d4edda;color:#155724;border:2px solid #c3e6cb}.error{background-color:#f8d7da;color:#721c24;border:2px solid #f5c6cb}.warning{background-color:#fff3cd;color:#856404;border:2px solid #ffeaa7}
.info-box{background-color:#f8f9fa;border:1px solid #e9ecef;border-radius:5px;padding:20px;margin:20px 0}.stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin:20px 0}
.stat-card{background-color:white;border-radius:5px;padding:15px;text-align:center;box-shadow:0 2px 4px rgba(0,0,0,0.1)}.stat-value{font-size:32px;font-weight:bold;margin:10px 0}.stat-label{font-size:14px;color:#6c757d}
.success-stat{border-top:4px solid #28a745}.error-stat{border-top:4px solid #dc3545}.skipped-stat{border-top:4px solid #ffc107}.total-stat{border-top:4px solid #007bff}.files-list{margin:20px 0}
.file-item{background-color:#e9ecef;padding:12px;border-radius:5px;margin:8px 0;display:flex;justify-content:space-between;align-items:center}.file-name{font-family:'Courier New',monospace;font-size:14px}
.file-size{font-weight:bold;color:#495057}.footer{margin-top:30px;padding-top:20px;border-top:1px solid #e9ecef;color:#6c757d;font-size:12px;text-align:center}.duration{font-size:14px;color:#495057;margin-top:10px}</style></head><body>
<div class=\"container\"><div class=\"header\"><h1>üìä –°–í–û–î–ù–´–ô –û–¢–ß–ï–¢ –û –ë–≠–ö–ê–ü–ï</h1><p>Backup Rebel - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ</p></div>
<div class=\"status ${I}\"><h2>${J} ${K}</h2></div><div class=\"info-box\"><h3>üìã –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3><div class=\"info-row\"><div class=\"info-label\">–•–æ—Å—Ç:</div><div>${G}</div></div>
<div class=\"info-row\"><div class=\"info-label\">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è:</div><div>${H}</div></div><div class=\"info-row\"><div class=\"info-label\">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</div><div><strong>${F} —Å–µ–∫—É–Ω–¥</strong></div></div></div>
<div class=\"info-box\"><h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—ç–∫–∞–ø–∞</h3><div class=\"stats-grid\"><div class=\"stat-card total-stat\"><div class=\"stat-value\">${D}</div><div class=\"stat-label\">–í—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–æ–≤</div></div>
<div class=\"stat-card success-stat\"><div class=\"stat-value\" style=\"color: #28a745;\">${A}</div><div class=\"stat-label\">–£—Å–ø–µ—à–Ω–æ</div></div>
<div class=\"stat-card error-stat\"><div class=\"stat-value\" style=\"color: #dc3545;\">${B}</div><div class=\"stat-label\">–û—à–∏–±–∫–∏</div></div>
<div class=\"stat-card skipped-stat\"><div class=\"stat-value\" style=\"color: #ffc107;\">${C}</div><div class=\"stat-label\">–ü—Ä–æ–ø—É—â–µ–Ω–æ</div></div></div></div>"
if [ ${#E[@]} -gt 0 ] && [ "$as" = "true" ];then L="${L}<div class=\"info-box\"><h3>üìé –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∞—Ä—Ö–∏–≤—ã (${#E[@]})</h3><div class=\"files-list\">"
for M in "${E[@]}";do if [ -f "$M" ];then local N=$(aA "$M");local O=$(aB "$N");L="${L}<div class=\"file-item\"><div class=\"file-name\">üì¶ $(basename \"$M\")</div><div class=\"file-size\">${O}</div></div>";fi;done
L="${L}</div></div>";fi;L="${L}<div class=\"footer\"><p>–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–º Backup Rebel</p><p>–î–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: ${H}</p><p class=\"duration\">–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ${F} —Å–µ–∫—É–Ω–¥</p></div></div></body></html>"
local P="${aq} –°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç: ${A}/${D} —É—Å–ø–µ—à–Ω–æ - ${H}";local Q=();if [ ${#E[@]} -gt 0 ] && [ "$as" = "true" ];then if [ ${#E[@]} -gt 3 ] && [ "$au" = "true" ];then local R="/tmp/backup_summary_$(date +%s).tar.gz"
ax "INFO" "–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –∏–∑ ${#E[@]} —Ñ–∞–π–ª–æ–≤ –¥–ª—è email";tar -czf "$R" "${E[@]}" 2>/dev/null;if [ -f "$R" ];then Q+=("$R");else for ((S=0; S<${#E[@]} && S<3; S++));do if [ -f "${E[$S]}" ];then Q+=("${E[$S]}");fi;done;fi;else local T=3
if [ "$at" -gt 10 ];then T=5;fi;for ((S=0; S<${#E[@]} && S<T; S++));do if [ -f "${E[$S]}" ];then Q+=("${E[$S]}");fi;done;fi;fi;local U=0;local V=0
IFS=',' read -ra W <<< "$ap";for X in "${W[@]}";do local Y=$(echo "$X" | xargs);if [ -n "$Y" ];then if aS "$Y" "$P" "$L" "${Q[@]}";then U=$((U + 1));else V=$((V + 1));fi;fi;done
if [ -n "$R" ] && [ -f "$R" ];then rm -f "$R";fi;ax "EMAIL" "–°–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω: $U –ø–æ–ª—É—á–∞—Ç–µ–ª—è–º, –æ—à–∏–±–æ–∫: $V";if [ $U -gt 0 ];then return 0;else return 1;fi;}
aV(){ if [ "$aj" != "true" ];then echo -e "${n}Email –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –æ—Ç–∫–ª—é—á–µ–Ω${x}";return 1;fi;echo -e "${s}=== –¢–ï–°–¢–û–í–ê–Ø –û–¢–ü–†–ê–í–ö–ê EMAIL ===${x}";local A=$(hostname 2>/dev/null || echo "unknown")
local B=$(date '+%Y-%m-%d %H:%M:%S');local C="/tmp/email_test_$(date +%s).txt";{ echo "–¢–ï–°–¢–û–í–´–ô –§–ê–ô–õ –î–õ–Ø –ü–†–û–í–ï–†–ö–ò EMAIL –û–¢–ü–†–ê–í–ö–ò";echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
echo "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: $B";echo "–•–æ—Å—Ç: $A";echo "–°–∫—Ä–∏–ø—Ç: Backup Rebel";echo "–í–µ—Ä—Å–∏—è: 0.5 Beta";echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê";echo "";echo "–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã email –æ—Ç–ø—Ä–∞–≤–∫–∏."
echo "–ï—Å–ª–∏ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ —ç—Ç–æ—Ç —Ñ–∞–π–ª –∫–∞–∫ –≤–ª–æ–∂–µ–Ω–∏–µ, –∑–Ω–∞—á–∏—Ç –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.";echo "";echo "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Email:";echo "  ‚Ä¢ SMTP —Å–µ—Ä–≤–µ—Ä: $ak:$al";echo "  ‚Ä¢ –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å: $ao";echo "  ‚Ä¢ –ü–æ–ª—É—á–∞—Ç–µ–ª—å: $ap"
echo "  ‚Ä¢ –ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: ${at}MB";echo "  ‚Ä¢ –°–∂–∞—Ç–∏–µ –≤–ª–æ–∂–µ–Ω–∏–π: $au";echo "";echo "‚úÖ –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù –£–°–ü–ï–®–ù–û";} > "$C";local D="<!DOCTYPE html><html><head><meta charset=\"UTF-8\"><style>body{font-family:Arial,sans-serif;line-height:1.6;color:#333}
.container{max-width:600px;margin:0 auto;padding:20px}.header{background-color:#4CAF50;color:white;padding:20px;border-radius:5px;text-align:center}.content{background-color:#f9f9f9;padding:20px;border-radius:5px;margin:20px 0}
.footer{text-align:center;color:#666;font-size:12px;margin-top:20px}</style></head><body><div class=\"container\"><div class=\"header\"><h1>üìß –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ Email</h1><p>Backup Rebel - —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è</p></div>
<div class=\"content\"><h2>‚úÖ –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ email –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ!</h2><p><strong>–•–æ—Å—Ç:</strong> $A</p><p><strong>–í—Ä–µ–º—è:</strong> $B</p><p><strong>–°—Ç–∞—Ç—É—Å:</strong> ‚úÖ –¢–ï–°–¢–û–í–ê–Ø –û–¢–ü–†–ê–í–ö–ê</p>
<p>–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤–æ–µ –ø–∏—Å—å–º–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.</p><div style=\"background-color:#e8f5e9;padding:15px;border-radius:5px;margin:15px 0\"><h3>üìé –í–ª–æ–∂–µ–Ω–∏–µ:</h3>
<p>–ö –ø–∏—Å—å–º—É –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤–ª–æ–∂–µ–Ω–∏–π.</p></div></div><div class=\"footer\"><p>–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–º Backup Rebel</p><p>–î–∞—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏: $B</p></div></div></body></html>"
local E="${aq} –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ email - $B";echo -e "${q}–û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ email –Ω–∞ –∞–¥—Ä–µ—Å: $ap${x}";if aS "$ap" "$E" "$D" "$C";then echo -e "${o}‚úì –¢–µ—Å—Ç–æ–≤—ã–π email –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ${x}";else echo -e "${n}‚úó –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ email${x}";fi
rm -f "$C";echo -e "${q}–¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —É–¥–∞–ª–µ–Ω${x}";}
aW(){ local A="$1";local B="$2";if [ "$Y" != "true" ] || [ -z "$Z" ] || [ -z "$aa" ];then ax "DEBUG" "Telegram –æ—Ç–∫–ª—é—á–µ–Ω –∏–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω: Y=$Y, TOKEN=${#Z}, CHAT_ID=${#aa}";return 0;fi
local C="https://api.telegram.org/bot${Z}/sendMessage";local D="chat_id=${aa}&text=$(echo -n "$A" | sed 's/&/%26/g')&parse_mode=${ah}";if [ -n "$ab" ];then D="${D}&message_thread_id=${ab}";fi
ax "DEBUG" "–û—Ç–ø—Ä–∞–≤–∫–∞ Telegram —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ URL: $(echo "$C" | sed "s/${Z}/[TOKEN]/g")";local E=$(curl -s -X POST "$C" -d "$D" 2>/dev/null);if echo "$E" | grep -q '"ok":true';then ax "TELEGRAM" "–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ";return 0
else ax "ERROR" "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram";ax "DEBUG" "–û—Ç–≤–µ—Ç Telegram API: $E";echo "$E" >> "$k";return 1;fi;}
aX(){ local A="$1";local B="$2";ax "DEBUG" "send_telegram_file –≤—ã–∑–≤–∞–Ω–∞ —Å —Ñ–∞–π–ª–æ–º: $A";if [ "$Y" != "true" ] || [ -z "$Z" ] || [ -z "$aa" ];then ax "DEBUG" "Telegram –æ—Ç–∫–ª—é—á–µ–Ω –∏–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω: Y=$Y, TOKEN=${#Z}, CHAT_ID=${#aa}";return 0;fi
if [ "$ac" != "true" ];then ax "DEBUG" "–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤ –æ—Ç–∫–ª—é—á–µ–Ω–∞";return 0;fi;if [ ! -f "$A" ];then ax "ERROR" "–§–∞–π–ª –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω: $A";return 1;fi;local C=$(aA "$A");ax "DEBUG" "–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ $A: $C –±–∞–π—Ç ($(aB "$C"))"
local D=$((ad * 1024 * 1024));if [ "$C" -gt "$D" ] 2>/dev/null;then if [ "$ag" = "true" ];then local E="${A}.gz";ax "INFO" "–°–∂–∞—Ç–∏–µ —Ñ–∞–π–ª–∞ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ Telegram: $(basename "$A")"
if gzip -c "$A" > "$E" 2>/dev/null;then A="$E";C=$(aA "$A");B="${B} (—Å–∂–∞—Ç–æ)";ax "DEBUG" "–§–∞–π–ª —Å–∂–∞—Ç, –Ω–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: $C –±–∞–π—Ç ($(aB "$C"))";else ax "ERROR" "–ù–µ —É–¥–∞–ª–æ—Å—å —Å–∂–∞—Ç—å —Ñ–∞–π–ª";return 1;fi;else ax "WARNING" "–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ ($(aB "$C") > $(aB "$D"))";return 1;fi;fi
local F="https://api.telegram.org/bot${Z}/sendDocument";local G=("-s" "-X" "POST" "-F" "chat_id=${aa}" "-F" "document=@${A}");if [ -n "$B" ];then local H=$(echo "$B" | sed 's/"/\\"/g');G+=("-F" "caption=\"${H}\"");fi
if [ -n "$ah" ] && [ -n "$B" ];then G+=("-F" "parse_mode=${ah}");fi;if [ -n "$ab" ];then G+=("-F" "message_thread_id=${ab}");fi;G+=("--connect-timeout" "30" "--max-time" "120" "-k")
ax "TELEGRAM" "–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞ –≤ Telegram: $(basename "$A") ($(aB "$C"))";ax "DEBUG" "URL API: $(echo "$F" | sed "s/${Z}/[TOKEN]/g")";if [ ! -r "$A" ];then ax "ERROR" "–§–∞–π–ª –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è: $A";return 1;fi
local I;local J;I=$(curl "${G[@]}" "$F" 2>&1);J=$?;ax "DEBUG" "Curl exit code: $J";if [[ "$A" == *.gz ]] && [ -f "$A" ] && [[ "$A" != "$1" ]];then rm -f "$A";ax "DEBUG" "–£–¥–∞–ª–µ–Ω –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∂–∞—Ç—ã–π —Ñ–∞–π–ª";fi
if [ $J -ne 0 ];then ax "ERROR" "Curl –æ—à–∏–±–∫–∞: $J";ax "DEBUG" "Curl stderr: $I";return 1;fi;if echo "$I" | grep -q '"ok":true';then ax "TELEGRAM" "–§–∞–π–ª –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ: $(basename "$A")";return 0
else ax "ERROR" "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª –≤ Telegram";ax "DEBUG" "–û—Ç–≤–µ—Ç Telegram API: $I";if echo "$I" | grep -q '"ok":false';then local K=$(echo "$I" | grep -o '"error_code":[0-9]*' | cut -d: -f2)
local L=$(echo "$I" | grep -o '"description":"[^"]*"' | cut -d'"' -f4);if [ -n "$K" ];then ax "ERROR" "–ö–æ–¥ –æ—à–∏–±–∫–∏ Telegram: $K";fi;if [ -n "$L" ];then ax "ERROR" "–û–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏: $L";fi;fi;echo "$I" >> "$k";return 1;fi;}
aY(){ if [ $# -eq 0 ];then ax "ERROR" "–ù–µ –ø–µ—Ä–µ–¥–∞–Ω—ã —Ñ–∞–π–ª—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏";return 1;fi;local A=("$@");ax "DEBUG" "send_telegram_files_combined –≤—ã–∑–≤–∞–Ω–∞ —Å ${#A[@]} —Ñ–∞–π–ª–∞–º–∏"
if [ "$Y" != "true" ];then ax "DEBUG" "Telegram –æ—Ç–∫–ª—é—á–µ–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É";return 0;fi;if [ -z "$Z" ] || [ -z "$aa" ];then ax "ERROR" "–ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω Telegram bot token –∏–ª–∏ chat id";return 1;fi
if [ "$ac" != "true" ];then ax "DEBUG" "–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤ –æ—Ç–∫–ª—é—á–µ–Ω–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö";return 0;fi;local B=$(hostname 2>/dev/null || echo "unknown");local C=$(date '+%Y-%m-%d %H:%M:%S');local D=$(date +%s)
ax "TELEGRAM" "–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –∏–∑ ${#A[@]} —Ñ–∞–π–ª–æ–≤";local E="/tmp/telegram_archive_${D}";mkdir -p "$E";local F=0;for G in "${A[@]}";do if [ -f "$G" ];then cp "$G" "$E/";local H=$(aA "$G");F=$((F + H));fi;done
local I="$E/archive_info.txt";{ echo "üì¶ –ê–†–•–ò–í –ë–≠–ö–ê–ü–û–í";echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê";echo "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: $C";echo "–•–æ—Å—Ç: $B";echo "–§–∞–π–ª–æ–≤: ${#A[@]}";echo "–û–±—â–∏–π —Ä–∞–∑–º–µ—Ä: $(aB $F)";echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
echo "";echo "–°–ü–ò–°–û–ö –§–ê–ô–õ–û–í:";echo "";} > "$I";for G in "${A[@]}";do if [ -f "$G" ];then local J=$(basename "$G");local H=$(aA "$G");local K=$(aB "$H");echo "‚Ä¢ $J ($K)" >> "$I";fi;done
local L="/tmp/backup_archive_${D}.tar.gz";cd "$E" && tar -czf "$L" . 2>/dev/null;local M=$(aA "$L");local N=$(aB "$M");local O=$((ad * 1024 * 1024));ax "TELEGRAM" "–†–∞–∑–º–µ—Ä –∞—Ä—Ö–∏–≤–∞: $N";rm -rf "$E"
if [ "$M" -gt "$O" ] 2>/dev/null;then ax "WARNING" "–ê—Ä—Ö–∏–≤ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π ($N > $(aB $O))";if [ "$ag" = "true" ];then local P="${L}.gz";if gzip -c "$L" > "$P" 2>/dev/null;then local Q=$(aA "$P");local R=$(aB "$Q")
if [ "$Q" -gt "$O" ] 2>/dev/null;then ax "ERROR" "–î–∞–∂–µ —Å–∂–∞—Ç—ã–π –∞—Ä—Ö–∏–≤ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π ($R)";rm -f "$L" "$P";return 1;fi;L="$P";N="$R";ax "SUCCESS" "–ê—Ä—Ö–∏–≤ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å–∂–∞—Ç: $R";fi;else ax "ERROR" "–ê—Ä—Ö–∏–≤ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏";rm -f "$L";return 1;fi;fi
local S="<b>üì¶ –ê–†–•–ò–í –ë–≠–ö–ê–ü–û–í</b>";S="${S}"$'\n'"";S="${S}"$'\n'"üñ•Ô∏è  <b>–•–æ—Å—Ç:</b> <code>$B</code>";S="${S}"$'\n'"üìÖ <b>–î–∞—Ç–∞:</b> $C";S="${S}"$'\n'"üìä <b>–§–∞–π–ª–æ–≤ –≤ –∞—Ä—Ö–∏–≤–µ:</b> ${#A[@]}"
S="${S}"$'\n'"‚ö° <b>–†–∞–∑–º–µ—Ä –∞—Ä—Ö–∏–≤–∞:</b> <code>$N</code>";S="${S}"$'\n'"";S="${S}"$'\n'"<i>–ê—Ä—Ö–∏–≤ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Ñ–∞–π–ª—ã –±—ç–∫–∞–ø–∞ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –∑–∞–≥—Ä—É–∑–∫–∏</i>";ax "TELEGRAM" "–û—Ç–ø—Ä–∞–≤–∫–∞ –∞—Ä—Ö–∏–≤–∞ –≤ Telegram";local T=0
if aX "$L" "$S";then ax "SUCCESS" "–ê—Ä—Ö–∏–≤ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω";else ax "ERROR" "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∞—Ä—Ö–∏–≤";T=1;fi;rm -f "$L";return $T;}
aZ(){ local A=("$@");if [ ${#A[@]} -eq 0 ];then ax "WARNING" "–ù–µ—Ç —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏";return 0;fi;ax "DEBUG" "send_telegram_files_universal –≤—ã–∑–≤–∞–Ω–∞ —Å ${#A[@]} —Ñ–∞–π–ª–∞–º–∏";local B=()
for C in "${A[@]}";do ax "DEBUG" "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞: $C";if [ -f "$C" ];then local D=$(aA "$C");ax "DEBUG" "–§–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: $C, —Ä–∞–∑–º–µ—Ä: $D –±–∞–π—Ç ($(aB "$D"))";if [ "$D" -gt 0 ] 2>/dev/null;then B+=("$C")
ax "DEBUG" "–§–∞–π–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–ø–∏—Å–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏";else ax "ERROR" "–§–∞–π–ª –∏–º–µ–µ—Ç –Ω—É–ª–µ–≤–æ–π —Ä–∞–∑–º–µ—Ä –∏–ª–∏ –Ω–µ—á–∏—Ç–∞–µ–º: $C";fi;else ax "ERROR" "–§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: $C";fi;done;if [ ${#B[@]} -eq 0 ];then ax "ERROR" "–ù–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏";return 1;fi
ax "DEBUG" "–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏: ${#B[@]}";ax "TELEGRAM" "–ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É –æ–¥–Ω–∏–º –∞—Ä—Ö–∏–≤–æ–º";aY "${B[@]}";return $?;}
ba(){ if [ "$Y" != "true" ] || [ -z "$Z" ] || [ -z "$aa" ];then echo -e "${n}Telegram –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –æ—Ç–∫–ª—é—á–µ–Ω${x}";return 1;fi;echo -e "${s}=== –¢–ï–°–¢–û–í–ê–Ø –û–¢–ü–†–ê–í–ö–ê –§–ê–ô–õ–ê –í TELEGRAM ===${x}";local A=$(date '+%Y-%m-%d %H:%M:%S')
local B=$(hostname 2>/dev/null || echo "unknown");local C="/tmp/telegram_test_file_$(date +%s).txt";{ echo "–¢–ï–°–¢–û–í–´–ô –§–ê–ô–õ –î–õ–Ø –ü–†–û–í–ï–†–ö–ò TELEGRAM –ë–û–¢–ê";echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê";echo "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: $A";echo "–•–æ—Å—Ç: $B"
echo "–°–∫—Ä–∏–ø—Ç: Backup Rebel";echo "–í–µ—Ä—Å–∏—è: 0.5 Beta";echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê";echo "";echo "–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã Telegram –±–æ—Ç–∞.";echo "–ï—Å–ª–∏ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ —ç—Ç–æ—Ç —Ñ–∞–π–ª, –∑–Ω–∞—á–∏—Ç –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ."
echo "";echo "–ú–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏: –∞—Ä—Ö–∏–≤–æ–º (combined)";echo "–ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: ${ad}MB";echo "–°–∂–∞—Ç–∏–µ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π: $ag";echo "–†–∞–∑–º–µ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π: $ah";echo "";echo "‚úÖ –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù –£–°–ü–ï–®–ù–û";} > "$C";local D="<b>üìã –¢–ï–°–¢–û–í–ê–Ø –û–¢–ü–†–ê–í–ö–ê –§–ê–ô–õ–ê</b>"
D="${D}"$'\n'"";D="${D}"$'\n'"<b>–•–æ—Å—Ç:</b> <code>$B</code>";D="${D}"$'\n'"<b>–í—Ä–µ–º—è:</b> <code>$A</code>";D="${D}"$'\n'"<b>–°—Ç–∞—Ç—É—Å:</b> ‚úÖ <b>–¢–ï–°–¢ –û–¢–ü–†–ê–í–ö–ò –§–ê–ô–õ–ê</b>";D="${D}"$'\n'"";D="${D}"$'\n'"<i>–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã Telegram –±–æ—Ç–∞</i>"
echo -e "${q}–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª: $C${x}";echo -e "${q}–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞ –≤ Telegram...${x}";if aX "$C" "$D";then echo -e "${o}‚úì –¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ${x}";local E="<b>‚úÖ –¢–ï–°–¢–û–í–ê–Ø –û–¢–ü–†–ê–í–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê</b>"
E="${E}"$'\n'"";E="${E}"$'\n'"<b>–•–æ—Å—Ç:</b> <code>$B</code>";E="${E}"$'\n'"<b>–í—Ä–µ–º—è:</b> <code>$A</code>";E="${E}"$'\n'"<b>–°—Ç–∞—Ç—É—Å:</b> ‚úÖ <b>–û–¢–ü–†–ê–í–ö–ê –§–ê–ô–õ–ê –ü–†–û–®–õ–ê –£–°–ü–ï–®–ù–û</b>";E="${E}"$'\n'"";E="${E}"$'\n'"<i>–¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –±—ã–ª –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –∫–∞–∫ –¥–æ–∫—É–º–µ–Ω—Ç</i>"
aW "$E";else echo -e "${n}‚úó –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞${x}";fi;rm -f "$C";echo -e "${q}–¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —É–¥–∞–ª–µ–Ω${x}";}
bb(){ echo "proj_$(date +%s)_${RANDOM}";}
bc(){ echo "dir_$(date +%s)_${RANDOM}";}
bd(){ echo "db_$(date +%s)_${RANDOM}";}
be(){ local A="$1";local B="$2";local C="$3";local D="$m/$A.project";{ echo "name=$B";echo "enabled=$C";echo "dirs_count=0";echo "dbs_count=0";} > "$D";}
bf(){ local A="$1";local B="$m/$A.project";if [ -f "$B" ];then grep '^name=' "$B" | cut -d'=' -f2-;else echo "";fi;}
bg(){ if [ -f "$m/projects.list" ];then grep -v '^#' "$m/projects.list" | grep -v '^$';else echo "";fi;}
bh(){ local A=0;if [ -f "$m/projects.list" ];then A=$(grep -v '^#' "$m/projects.list" | grep -v '^$' | wc -l);fi;echo "$A";}
bi(){ local A="$1";local B="${2:-true}";local C=$(bb);be "$C" "$A" "$B";echo "$C" >> "$m/projects.list";echo "$C";}
bj(){ local A="$1";local B="$2";local C=$(bc);local D="$m/$A.project";if [ ! -f "$D" ];then echo "$C";return;fi;echo "$B" >> "$m/$A.dirs";local E=$(grep '^dirs_count=' "$D" | cut -d'=' -f2);E=${E:-0}
local F=$((E + 1));sed -i "s/^dirs_count=.*/dirs_count=$F/" "$D";echo "$C";}
bk(){ local A="$1";local B="$2";local C="$3";local D="$4";local E="$5";local F="${6:-none}";local G="${7:-manual}";local H=$(bd);local I="$m/$A.project";if [ ! -f "$I" ];then echo "$H";return;fi
local J="$m/$A.dbs";echo "$B|$C|$D|$E|$F|$G" >> "$J";local K=$(grep '^dbs_count=' "$I" | cut -d'=' -f2);K=${K:-0};local L=$((K + 1));sed -i "s/^dbs_count=.*/dbs_count=$L/" "$I";echo "$H";}
bl(){ local A="$1";local B="$m/$A.dirs";if [ -f "$B" ];then cat "$B";fi;}
bm(){ local A="$1";local B="$m/$A.dbs";if [ -f "$B" ];then cat "$B";fi;}
bn(){ local A="$1";local B="$m/$A.project";if [ -f "$B" ];then grep '^dirs_count=' "$B" | cut -d'=' -f2;else echo "0";fi;}
bo(){ local A="$1";local B="$m/$A.project";if [ -f "$B" ];then grep '^dbs_count=' "$B" | cut -d'=' -f2;else echo "0";fi;}
bp(){ local A="$1";local B="$m/$A.project";if [ -f "$B" ];then local C=$(grep '^enabled=' "$B" | cut -d'=' -f2);[ "$C" = "true" ];else false;fi;}
bq(){ echo "sch_$(date +%s)_${RANDOM}";}
br(){ local A="$1";local B="$2";local C="${3:-true}";local D=$(bq);local E="$m/$A.schedule";echo "$B|$C|$D" >> "$E";echo "$D";}
bs(){ local A="$1";local B="$m/$A.schedule";if [ -f "$B" ] && [ -s "$B" ];then cat "$B";else echo "";fi;}
bt(){ local A="$1";local B="$m/$A.schedule";if [ -f "$B" ] && [ -s "$B" ];then head -1 "$B" | cut -d'|' -f1;else echo "";fi;}
bu(){ local A="$1";local B="$m/$A.schedule";if [ -f "$B" ] && [ -s "$B" ];then local C=$(head -1 "$B" | cut -d'|' -f2);[ "$C" = "true" ];else false;fi;}
bv(){ local A="$1";local B="$m/$A.schedule";if [ -f "$B" ];then rm -f "$B";echo -e "${o}‚úì –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ${x}";else echo -e "${p}‚ö† –£ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è${x}";fi;}
bw(){ local A="$1";IFS=' ' read -r B C D E F <<< "$A";if [ -z "$B" ] || [ -z "$C" ] || [ -z "$D" ] || [ -z "$E" ] || [ -z "$F" ];then echo -e "${n}–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: '–º–∏–Ω—É—Ç—ã —á–∞—Å—ã –¥–µ–Ω—å –º–µ—Å—è—Ü –¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏'${x}";return 1;fi
if ! [[ "$B" =~ ^([0-9]|[1-5][0-9]|\*|\*\/[0-9]+)$ ]];then echo -e "${n}–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–∏–Ω—É—Ç: $B${x}";return 1;fi;if ! [[ "$C" =~ ^([0-9]|1[0-9]|2[0-3]|\*|\*\/[0-9]+)$ ]];then echo -e "${n}–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —á–∞—Å–æ–≤: $C${x}";return 1;fi
if ! [[ "$D" =~ ^([1-9]|[12][0-9]|3[01]|\*|\*\/[0-9]+)$ ]];then echo -e "${n}–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–Ω—è –º–µ—Å—è—Ü–∞: $D${x}";return 1;fi;if ! [[ "$E" =~ ^([1-9]|1[0-2]|\*|\*\/[0-9]+)$ ]];then echo -e "${n}–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Å—è—Ü–∞: $E${x}";return 1;fi
if ! [[ "$F" =~ ^([0-6]|\*|\*\/[0-9]+)$ ]];then echo -e "${n}–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–Ω—è –Ω–µ–¥–µ–ª–∏: $F${x}";return 1;fi;echo -e "${o}‚úì –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ${x}";return 0;}
bx(){ echo "";echo -e "${s}=== –ü–†–ò–ú–ï–†–´ –†–ê–°–ü–ò–°–ê–ù–ò–ô ===${x}";echo "";echo "1) –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 2:00 –Ω–æ—á–∏:         0 2 * * *";echo "2) –ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 3:30 —É—Ç—Ä–∞:         30 3 * * *";echo "3) –ö–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤:                0 */6 * * *"
echo "4) –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç:               */30 * * * *";echo "5) –ü–æ –±—É–¥–Ω—è–º –≤ 1:00:              0 1 * * 1-5";echo "6) –ü–æ –≤—ã—Ö–æ–¥–Ω—ã–º –≤ 4:00:            0 4 * * 0,6";echo "7) 1-–≥–æ —á–∏—Å–ª–∞ –∫–∞–∂–¥–æ–≥–æ –º–µ—Å—è—Ü–∞:     0 0 1 * *";echo "8) –ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 5:00:     0 5 * * 1"
echo "9) –ö–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç:               */15 * * * *";echo "10) –î–≤–∞–∂–¥—ã –≤ –¥–µ–Ω—å (2:00 –∏ 14:00): 0 2,14 * * *";echo "";echo -e "${p}–§–æ—Ä–º–∞—Ç: –º–∏–Ω—É—Ç—ã —á–∞—Å—ã –¥–µ–Ω—å –º–µ—Å—è—Ü –¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏${x}";echo "";}
by(){ local A=($(bg));local B=();for C in "${A[@]}";do if [ -f "$m/$C.schedule" ] && [ -s "$m/$C.schedule" ];then B+=("$C");fi;done;echo "${B[@]}";}
bz(){ local A="$1";local B=$(bt "$A");if [ -z "$B" ];then ax "DEBUG" "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ $A";return 1;fi;if ! bu "$A";then ax "DEBUG" "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ $A";return 1;fi
if ! bp "$A";then ax "DEBUG" "–ü—Ä–æ–µ–∫—Ç –æ—Ç–∫–ª—é—á–µ–Ω: $A";return 1;fi;local C=$(date +%M);local D=$(date +%H);local E=$(date +%d);local F=$(date +%m);local G=$(date +%u);local H=$((G % 7))
IFS=' ' read -r I J K L M <<< "$B";ax "DEBUG" "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ $A";ax "DEBUG" "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: $B";ax "DEBUG" "–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: $D:$C –¥–µ–Ω—å:$E –º–µ—Å—è—Ü:$F –¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏:$H ($G)"
bA(){ local N="$1";local O="$2";local P="$3";if [ "$N" = "*" ];then ax "DEBUG" "$P: $N —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å $O (–∑–≤–µ–∑–¥–æ—á–∫–∞)";return 0;fi
if echo "$N" | grep -q '^[0-9]\+$';then if [ "$O" = "$N" ];then ax "DEBUG" "$P: $N —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å $O (—Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)";return 0;else ax "DEBUG" "$P: $N –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å $O (—Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)";return 1;fi;fi
if echo "$N" | grep -q '^[0-9]\+-[0-9]\+$';then local Q=$(echo "$N" | cut -d'-' -f1);local R=$(echo "$N" | cut -d'-' -f2);Q=$((10#$Q));R=$((10#$R));local S=$((10#$O));if [ $S -ge $Q ] && [ $S -le $R ];then ax "DEBUG" "$P: $O –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ $N";return 0
else ax "DEBUG" "$P: $O –Ω–µ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ $N";return 1;fi;fi;if echo "$N" | grep -q ',';then IFS=',' read -ra T <<< "$N";for U in "${T[@]}";do U=$(echo "$U" | xargs);if [ "$O" = "$U" ];then ax "DEBUG" "$P: $O –Ω–∞–π–¥–µ–Ω–æ –≤ —Å–ø–∏—Å–∫–µ $N";return 0;fi
if echo "$U" | grep -q '^[0-9]\+-[0-9]\+$';then local V=$(echo "$U" | cut -d'-' -f1);local W=$(echo "$U" | cut -d'-' -f2);V=$((10#$V));W=$((10#$W));local X=$((10#$O));if [ $X -ge $V ] && [ $X -le $W ];then ax "DEBUG" "$P: $O –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ $U –∏–∑ —Å–ø–∏—Å–∫–∞ $N";return 0;fi;fi;done
ax "DEBUG" "$P: $O –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ —Å–ø–∏—Å–∫–µ $N";return 1;fi;if echo "$N" | grep -q '^\*/[0-9]\+$';then local Y=$(echo "$N" | cut -d'/' -f2);local Z=$((10#$O));if [ $((Z % Y)) -eq 0 ];then ax "DEBUG" "$P: $O –¥–µ–ª–∏—Ç—Å—è –Ω–∞ $Y –±–µ–∑ –æ—Å—Ç–∞—Ç–∫–∞";return 0
else ax "DEBUG" "$P: $O –Ω–µ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ $Y –±–µ–∑ –æ—Å—Ç–∞—Ç–∫–∞";return 1;fi;fi;if echo "$N" | grep -q '^[0-9]\+-[0-9]\+/[0-9]\+$';then local a=$(echo "$N" | cut -d'/' -f1);local b=$(echo "$N" | cut -d'/' -f2)
local c=$(echo "$a" | cut -d'-' -f1);local d=$(echo "$a" | cut -d'-' -f2);c=$((10#$c));d=$((10#$d));local e=$((10#$O));if [ $e -ge $c ] && [ $e -le $d ] && [ $((e % b)) -eq 0 ];then ax "DEBUG" "$P: $O –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ $a –∏ –¥–µ–ª–∏—Ç—Å—è –Ω–∞ $b";return 0
else ax "DEBUG" "$P: $O –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç $N";return 1;fi;fi;ax "DEBUG" "$P: –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç: $N";return 1;}
if ! bA "$I" "$C" "–ú–∏–Ω—É—Ç—ã";then ax "DEBUG" "–ù–µ —Å–æ–≤–ø–∞–ª–∏ –º–∏–Ω—É—Ç—ã: $I != $C";return 1;fi;if ! bA "$J" "$D" "–ß–∞—Å—ã";then ax "DEBUG" "–ù–µ —Å–æ–≤–ø–∞–ª–∏ —á–∞—Å—ã: $J != $D";return 1;fi
if ! bA "$K" "$E" "–î–µ–Ω—å –º–µ—Å—è—Ü–∞";then ax "DEBUG" "–ù–µ —Å–æ–≤–ø–∞–ª –¥–µ–Ω—å –º–µ—Å—è—Ü–∞: $K != $E";return 1;fi;if ! bA "$L" "$F" "–ú–µ—Å—è—Ü";then ax "DEBUG" "–ù–µ —Å–æ–≤–ø–∞–ª –º–µ—Å—è—Ü: $L != $F";return 1;fi
if ! bA "$M" "$H" "–î–µ–Ω—å –Ω–µ–¥–µ–ª–∏";then ax "DEBUG" "–ù–µ —Å–æ–≤–ø–∞–ª –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏: $M != $H";return 1;fi;ax "DEBUG" "‚úì –í—Å–µ —É—Å–ª–æ–≤–∏—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ $A";return 0;}
bB(){ ax "CRON" "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ cron –∑–∞–¥–∞–Ω–∏–π";local A=$(mktemp);echo "# ==========================================" >> "$A";echo "# –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –ë–≠–ö–ê–ü–´ BACKUP-REBEL" >> "$A"
echo "# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ $(date)" >> "$A";echo "# ==========================================" >> "$A";echo "" >> "$A";echo "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin" >> "$A";echo "" >> "$A"
local B=($(by));if [ ${#B[@]} -eq 0 ];then ax "INFO" "–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ cron";echo "# –ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º" >> "$A";else ax "INFO" "–î–æ–±–∞–≤–ª—è–µ–º ${#B[@]} –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ cron"
for C in "${B[@]}";do if bu "$C" && bp "$C";then local D=$(bf "$C");local E=$(bt "$C");if [ -n "$E" ];then local F="$E root $(realpath "$0") --backup-project $C >> $k 2>&1";echo "$F" >> "$A"
ax "CRON" "–î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–æ–µ–∫—Ç: $D ($E)";fi;fi;done;fi;echo "" >> "$A";echo "# ==========================================" >> "$A";echo "# –ö–û–ù–ï–¶ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–• –ë–≠–ö–ê–ü–û–í" >> "$A";echo "# ==========================================" >> "$A"
mv "$A" "$d";chmod 600 "$d";if crontab "$d" 2>/dev/null;then ax "SUCCESS" "Cron –∑–∞–¥–∞–Ω–∏—è —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω—ã";echo "";echo -e "${s}=== –¢–ï–ö–£–©–ò–ï CRON –ó–ê–î–ê–ù–ò–Ø ===${x}";crontab -l | grep -A 100 "–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –ë–≠–ö–ê–ü–´";echo ""
else ax "ERROR" "–û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ cron –∑–∞–¥–∞–Ω–∏–π";fi;}
bC(){ ax "CRON" "–£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö cron –∑–∞–¥–∞–Ω–∏–π backup-rebel";local A=$(crontab -l 2>/dev/null);if [ -n "$A" ];then local B=$(echo "$A" | grep -v "backup-rebel\|$(realpath "$0")");echo "$B" | crontab -
if [ $? -eq 0 ];then ax "SUCCESS" "Cron –∑–∞–¥–∞–Ω–∏—è backup-rebel —É–¥–∞–ª–µ–Ω—ã";else ax "ERROR" "–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è cron –∑–∞–¥–∞–Ω–∏–π";fi;else ax "INFO" "–ù–µ—Ç cron –∑–∞–¥–∞–Ω–∏–π –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è";fi;}
bD(){ echo "";echo -e "${s}=== –¢–ï–ö–£–©–ò–ï CRON –ó–ê–î–ê–ù–ò–Ø BACKUP-REBEL ===${x}";echo "";local A=$(crontab -l 2>/dev/null | grep -A 100 "–ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –ë–≠–ö–ê–ü–´");if [ -n "$A" ];then echo "$A"
else echo -e "${p}–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö cron –∑–∞–¥–∞–Ω–∏–π –¥–ª—è backup-rebel${x}";fi;echo "";}
bE(){ if [ ! -f "$c" ];then ax "INFO" "–§–∞–π–ª –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π";rm -rf "$m";mkdir -p "$m";return;fi;ax "PROJECT" "–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤";rm -rf "$m";mkdir -p "$m"
local A="";local B="";local C="true";local D="";echo "# –°–ø–∏—Å–æ–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤" > "$m/projects.list";while IFS= read -r E || [ -n "$E" ];do E=$(echo "$E" | xargs);if [ -z "$E" ] || [[ "$E" == \#* ]];then continue;fi
if [[ "$E" =~ ^\[PROJECT: ]];then A=$(echo "$E" | sed 's/^\[PROJECT://' | sed 's/\]$//');D="project";echo "$A" >> "$m/projects.list";elif [ "$E" = "[DIRECTORIES]" ];then D="directories"
elif [ "$E" = "[DATABASES]" ];then D="databases";elif [ "$E" = "[SCHEDULE]" ];then D="schedule";elif [ "$E" = "[END_PROJECT]" ];then A="";B="";C="true";D=""
elif [ "$D" = "project" ] && [[ "$E" == name=* ]];then B=$(echo "$E" | sed 's/^name=//');if [ -n "$A" ] && [ -n "$B" ];then local F="$m/$A.project";{ echo "name=$B";echo "enabled=$C";echo "dirs_count=0";echo "dbs_count=0";} > "$F";fi
elif [ "$D" = "project" ] && [[ "$E" == enabled=* ]];then C=$(echo "$E" | sed 's/^enabled=//');elif [ "$D" = "directories" ] && [[ "$E" =~ ^\[/ ]];then local G=$(echo "$E" | sed 's/^\[//' | sed 's/\]$//')
if [ -n "$A" ] && [ -f "$m/$A.project" ];then echo "$G" >> "$m/$A.dirs";local H="$m/$A.project";local I=$(grep '^dirs_count=' "$H" | cut -d'=' -f2);I=${I:-0};local J=$((I + 1));sed -i "s/^dirs_count=.*/dirs_count=$J/" "$H";fi
elif [ "$D" = "databases" ] && [[ "$E" == db:* ]];then local K=$(echo "$E" | sed 's/^db://');IFS='|' read -r L M N O P Q <<< "$K";local R="";if [ -n "$O" ];then R=$(aE "$O");fi
if [ -n "$A" ] && [ -f "$m/$A.project" ];then local S="$m/$A.dbs";echo "$L|$M|$N|$R|$P|$Q" >> "$S";local T="$m/$A.project";local U=$(grep '^dbs_count=' "$T" | cut -d'=' -f2);U=${U:-0};local V=$((U + 1));sed -i "s/^dbs_count=.*/dbs_count=$V/" "$T";fi
elif [ "$D" = "schedule" ] && [[ "$E" == time=* ]];then local W=$(echo "$E" | sed 's/^time=//');local X=$(echo "$E" | sed 's/^enabled=//' 2>/dev/null || echo "true");if [ -n "$A" ] && [ -f "$m/$A.project" ];then local Y="$m/$A.schedule"
echo "$W|$X|sch_$(date +%s)_${RANDOM}" > "$Y";fi;fi;done < "$c";local Z=$(bh);ax "PROJECT" "–ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø—Ä–æ–µ–∫—Ç–æ–≤: $Z";}
bF(){ ax "PROJECT" "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤";if [ ! -f "$m/projects.list" ];then if [ -f "$c" ];then ax "INFO" "–û—Å—Ç–∞–≤–ª—è–µ–º —Å—Ç–∞—Ä—ã–π —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π";else echo "# –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–æ–µ–∫—Ç–æ–≤" > "$c";chmod 600 "$c";fi;return;fi
local A=();while IFS= read -r B || [ -n "$B" ];do if [ -n "$B" ];then A+=("$B");fi;done < "$m/projects.list";local C=$(mktemp);for D in "${A[@]}";do local E="$m/$D.project";if [ ! -f "$E" ];then continue;fi;local F=$(bf "$D");local G=$(grep '^enabled=' "$E" | cut -d'=' -f2)
echo "[PROJECT:$D]" >> "$C";echo "name=$F" >> "$C";echo "enabled=$G" >> "$C";echo "" >> "$C";echo "[DIRECTORIES]" >> "$C";local H="$m/$D.dirs";if [ -f "$H" ] && [ -s "$H" ];then while IFS= read -r I || [ -n "$I" ];do if [ -n "$I" ];then echo "[$I]" >> "$C";fi;done < "$H"
else echo "# –ù–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π" >> "$C";fi;echo "" >> "$C";echo "[DATABASES]" >> "$C";local J="$m/$D.dbs";if [ -f "$J" ] && [ -s "$J" ];then while IFS= read -r K || [ -n "$K" ];do if [ -n "$K" ];then IFS='|' read -r L M N O P Q <<< "$K"
local R=$(aD "$O");echo "db:$L|$M|$N|$R|$P|$Q" >> "$C";fi;done < "$J";else echo "# –ù–µ—Ç –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö" >> "$C";fi;echo "" >> "$C";echo "[SCHEDULE]" >> "$C";local S="$m/$D.schedule"
if [ -f "$S" ] && [ -s "$S" ];then while IFS= read -r T || [ -n "$T" ];do if [ -n "$T" ];then IFS='|' read -r U V W <<< "$T";echo "time=$U" >> "$C";echo "enabled=$V" >> "$C";fi;done < "$S";else echo "# –ù–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è" >> "$C";fi;echo "" >> "$C"
echo "[END_PROJECT]" >> "$C";echo "" >> "$C";done;mv "$C" "$c";chmod 600 "$c";ax "SUCCESS" "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞";bB;}
bG(){ ay;aC;if [ -f "$b" ];then ax "INFO" "–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏";. "$b" 2>/dev/null || ax "ERROR" "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏";fi;j="${j:-/var/backup-rebel}";l="${l:-7}";k="$j/backup.log";bE
if [ -f "$g" ];then ax "TELEGRAM" "–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Telegram";. "$g" 2>/dev/null || ax "ERROR" "–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Telegram";fi;aO;}
bH(){ { echo "BACKUP_DIR=\"$j\"";echo "RETENTION_DAYS=\"$l\"";} > "$b";chmod 600 "$b";bF;bI;aN;ax "SUCCESS" "–í—Å—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞";}
bI(){ { echo "TELEGRAM_ENABLED=\"$Y\"";echo "TELEGRAM_BOT_TOKEN=\"$Z\"";echo "TELEGRAM_CHAT_ID=\"$aa\"";echo "TELEGRAM_MESSAGE_THREAD_ID=\"$ab\"";echo "TELEGRAM_SEND_FILES=\"$ac\""
echo "TELEGRAM_MAX_FILE_SIZE=\"$ad\"";echo "TELEGRAM_NOTIFY_ON_SUCCESS=\"$ae\"";echo "TELEGRAM_NOTIFY_ON_FAILURE=\"$af\"";echo "TELEGRAM_COMPRESS_BEFORE_SEND=\"$ag\""
echo "TELEGRAM_PARSE_MODE=\"$ah\"";echo "TELEGRAM_SEND_METHOD=\"$ai\"";} > "$g";chmod 600 "$g";ax "TELEGRAM" "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã";}
bJ(){ local A="$1";if [ -z "$A" ];then echo -e "${n}ID –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ —É–∫–∞–∑–∞–Ω${x}";return 1;fi;local B="$m/$A.project";if [ ! -f "$B" ];then echo -e "${n}–ü—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω (ID: $A)${x}";echo -e "${p}–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã:${x}";local C=($(bg))
if [ ${#C[@]} -eq 0 ];then echo "  - –ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤";else for D in "${C[@]}";do local E=$(bf "$D");echo "  - $E (ID: $D)";done;fi;return 1;fi;local F=$(bf "$A");local G=$(grep '^enabled=' "$B" | cut -d'=' -f2);local H=$(bn "$A");local I=$(bo "$A")
local J=$(bt "$A");local K=$(bu "$A" && echo "true" || echo "false");echo "";echo -e "${s}=== –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ü–†–û–ï–ö–¢–ï ===${x}";echo "–ù–∞–∑–≤–∞–Ω–∏–µ: $F";echo "ID: $A";echo "–°—Ç–∞—Ç—É—Å: $(if [ "$G" = "true" ];then echo -e "${o}–≤–∫–ª—é—á–µ–Ω${x}";else echo -e "${n}–≤—ã–∫–ª—é—á–µ–Ω${x}";fi)"
echo "–î–∏—Ä–µ–∫—Ç–æ—Ä–∏–π: $H";echo "–ë–∞–∑ –¥–∞–Ω–Ω—ã—Ö: $I";if [ -n "$J" ];then echo "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: $J $(if [ "$K" = "true" ];then echo -e "${o}(–∞–∫—Ç–∏–≤–Ω–æ)${x}";else echo -e "${n}(–Ω–µ–∞–∫—Ç–∏–≤–Ω–æ)${x}";fi)";else echo "–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: ${p}–Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ${x}";fi
if [ $H -gt 0 ];then echo "";echo -e "${o}–î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞:${x}";local L=0;while IFS= read -r M || [ -n "$M" ];do if [ -n "$M" ];then L=$((L + 1));echo "  $L) $M";fi;done < "$m/$A.dirs" 2>/dev/null || echo "  –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π";fi
if [ $I -gt 0 ];then echo "";echo -e "${o}–ë–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞:${x}";local N=0;while IFS= read -r O || [ -n "$O" ];do if [ -n "$O" ];then N=$((N + 1));IFS='|' read -r P Q R S T U <<< "$O";echo "  $N) –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä: $P";echo "      –ë–∞–∑–∞: $Q, –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: $R"
echo "      –ü–∞—Ä–æ–ª—å: $(if [ -n "$S" ];then echo -e "${o}–µ—Å—Ç—å${x} ($T)";else echo -e "${n}–Ω–µ—Ç${x}";fi)";echo "";fi;done < "$m/$A.dbs" 2>/dev/null || echo "  –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –ë–î";fi;echo "";}
bK(){ echo "";echo -e "${s}=== –°–û–ó–î–ê–ù–ò–ï –ù–û–í–û–ì–û –ü–†–û–ï–ö–¢–ê ===${x}";read -p "–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: " A;if [ -z "$A" ];then echo -e "${n}–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º${x}";return 1;fi
local B=($(bg));for C in "${B[@]}";do if [ "$(bf "$C")" = "$A" ];then echo -e "${n}–ü—Ä–æ–µ–∫—Ç —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç${x}";return 1;fi;done;local D=$(bi "$A");echo -e "${o}‚úì –ü—Ä–æ–µ–∫—Ç '$A' —Å–æ–∑–¥–∞–Ω (ID: $D)${x}";echo ""
echo -e "${p}–•–æ—Ç–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±—ç–∫–∞–ø–∞? (y/N): ${x}";read -p "" E;if echo "$E" | grep -q '^[Yy]$';then bL "$D";fi
echo -e "${p}–•–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –≤ –ø—Ä–æ–µ–∫—Ç? (y/N): ${x}";read -p "" F;if echo "$F" | grep -q '^[Yy]$';then bM "$D";fi;echo -e "${p}–•–æ—Ç–∏—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–æ–µ–∫—Ç? (y/N): ${x}";read -p "" G;if echo "$G" | grep -q '^[Yy]$';then bN "$D";fi
bF;echo "";bJ "$D";echo "";echo -e "${o}‚úì –ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω${x}";}
bL(){ local A="$1";local B=$(bf "$A");echo "";echo -e "${s}=== –ù–ê–°–¢–†–û–ô–ö–ê –†–ê–°–ü–ò–°–ê–ù–ò–Ø –î–õ–Ø: $B ===${x}";local C=$(bt "$A");if [ -n "$C" ];then echo -e "${o}–¢–µ–∫—É—â–µ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ: $C${x}";echo "";fi;bx;while true;do
read -p "–í–≤–µ–¥–∏—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ (cron format) –∏–ª–∏ 'off' –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è: " D;if [ -z "$D" ];then continue;fi;if [ "$D" = "off" ];then bv "$A";echo -e "${p}‚úì –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ${x}";break;fi;if bw "$D";then bv "$A" 2>/dev/null
br "$A" "$D";echo -e "${o}‚úì –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ: $D${x}";bB;break;else echo -e "${n}–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑${x}";fi;done;}
bM(){ local A="$1";local B=$(bf "$A");echo "";echo -e "${s}=== –î–û–ë–ê–í–õ–ï–ù–ò–ï –î–ò–†–ï–ö–¢–û–†–ò–ô –í –ü–†–û–ï–ö–¢: $B ===${x}";while true;do echo "";read -p "–í–≤–µ–¥–∏—Ç–µ –ø—É—Ç—å –∫ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è): " C;if [ -z "$C" ];then break;fi
if [ ! -d "$C" ];then echo -e "${p}–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –°–æ–∑–¥–∞—Ç—å? (y/N): ${x}";read -p "" D;if echo "$D" | grep -q '^[Yy]$';then mkdir -p "$C" 2>/dev/null || { echo -e "${n}–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é${x}";continue;};echo -e "${o}–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–∑–¥–∞–Ω–∞${x}"
else echo -e "${p}–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–æ–ø—É—â–µ–Ω–∞${x}";continue;fi;fi;bj "$A" "$C";echo -e "${o}‚úì –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞: $C${x}";done;echo "";echo -e "${o}–î–æ–±–∞–≤–ª–µ–Ω–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π: $(bn "$A")${x}";}
bN(){ local A="$1";local B=$(bf "$A");echo "";echo -e "${s}=== –î–û–ë–ê–í–õ–ï–ù–ò–ï –ë–ê–ó –î–ê–ù–ù–´–• –í –ü–†–û–ï–ö–¢: $B ===${x}";local C=($(docker ps --format "{{.Names}}" | grep -E "postgres|db" | sort));while true;do echo ""
if [ ${#C[@]} -gt 0 ];then echo -e "${o}–ù–∞–π–¥–µ–Ω—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã:${x}";for D in "${!C[@]}";do echo "  $((D+1))) ${C[$D]}";done;echo "  0) –í–≤–µ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é";echo "  x) –ó–∞–≤–µ—Ä—à–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ";echo "";read -p "–í—ã–±–µ—Ä–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: " E;case $E in x|X) break ;;
0) read -p "–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: " F ;;*) if echo "$E" | grep -q '^[0-9]\+$' && [ $E -ge 1 ] && [ $E -le ${#C[@]} ];then local G=$((E-1));F="${C[$G]}";else echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä${x}";continue;fi;;esac
else echo -e "${p}–ù–µ –Ω–∞–π–¥–µ–Ω—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã PostgreSQL${x}";read -p "–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (–∏–ª–∏ 'x' –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è): " F;if [ "$F" = "x" ] || [ "$F" = "X" ];then break;fi;fi;if [ -z "$F" ];then continue;fi;read -p "–ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: " G
read -p "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è [postgres]: " H;H="${H:-postgres}";echo -e "${p}–í–≤–æ–¥ –ø–∞—Ä–æ–ª—è (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –µ—Å–ª–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è):${x}";read -sp "–ü–∞—Ä–æ–ª—å: " I;echo "";local J="manual";if [ -z "$I" ];then echo -e "${q}–ü–æ–∏—Å–∫ –ø–∞—Ä–æ–ª—è –≤ .env —Ñ–∞–π–ª–∞—Ö...${x}"
I=$(aM "$F" "$G" "$H");if [ -n "$I" ];then J="env";echo -e "${o}‚úì –ü–∞—Ä–æ–ª—å –Ω–∞–π–¥–µ–Ω –≤ .env${x}";else J="none";echo -e "${p}‚ö† –ü–∞—Ä–æ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω${x}";fi;fi;local K=false;if [ -n "$I" ];then if docker exec -e PGPASSWORD="$I" "$F" psql -U "$H" -lqt 2>/dev/null | grep -q "\b$G\b";then K=true;fi
else if docker exec "$F" psql -U "$H" -lqt 2>/dev/null | grep -q "\b$G\b";then K=true;fi;fi;if [ "$K" = true ];then echo -e "${o}‚úì –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î —É—Å–ø–µ—à–Ω–æ${x}";else echo -e "${p}‚ö† –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î${x}";read -p "–í—Å–µ —Ä–∞–≤–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å? (y/N): " L
if ! echo "$L" | grep -q '^[Yy]$';then continue;fi;fi;bk "$A" "$F" "$G" "$H" "$I" "$J";echo -e "${o}‚úì –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∞: $F ‚Üí $G${x}";done;echo "";echo -e "${o}–î–æ–±–∞–≤–ª–µ–Ω–æ –ë–î: $(bo "$A")${x}";}
bO(){ echo "";echo -e "${s}=== –í–°–ï –ü–†–û–ï–ö–¢–´ ===${x}";local A=($(bg));if [ ${#A[@]} -eq 0 ];then echo -e "${p}–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤${x}";return;fi;echo "";local B=1;for C in "${A[@]}";do local D=$(bf "$C");local E=$(bn "$C");local F=$(bo "$C")
local G=$(bp "$C" && echo "true" || echo "false");local H=$(bt "$C");local I=$(bu "$C" && echo "true" || echo "false");local J="";if [ "$G" = "true" ];then J="${o}–≤–∫–ª${x}";else J="${n}–≤—ã–∫–ª${x}";fi
local K="‚è≤Ô∏è ";if [ -n "$H" ];then if [ "$I" = "true" ];then K="${o}‚è≤Ô∏è ${x}";else K="${n}‚è≤Ô∏è ${x}";fi;else K="${p}‚è≤Ô∏è ${x}";fi;printf " %2d) %-25s üìÅ %2d | üóÑÔ∏è  %2d | %s | %s\n" "$B" "$D" "$E" "$F" "$J" "$K";B=$((B + 1));done;echo "";}
bP(){ local A="$1";if [ -z "$A" ];then echo "ID –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ —É–∫–∞–∑–∞–Ω";return 1;fi;local B=$(bf "$A");if [ -z "$B" ];then echo "–ü—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω";return 1;fi;echo "–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞: $B";read -p "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ (y/N): " C
if ! echo "$C" | grep -q '^[Yy]$';then echo "–û—Ç–º–µ–Ω–µ–Ω–æ";return;fi;rm -f "$m/$A.project" "$m/$A.dirs" "$m/$A.dbs" "$m/$A.schedule" 2>/dev/null;if [ -f "$m/projects.list" ];then grep -v "^$A$" "$m/projects.list" > "$m/projects.list.tmp"
mv "$m/projects.list.tmp" "$m/projects.list";fi;echo -e "${o}‚úì –ü—Ä–æ–µ–∫—Ç '$B' —É–¥–∞–ª–µ–Ω${x}";}
bQ(){ local A="$1";local B="$2";local C="$m/$A.dirs";if [ ! -f "$C" ];then echo "–£ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π";return 1;fi;local D=();while IFS= read -r E || [ -n "$E" ];do if [ -n "$E" ];then D+=("$E");fi;done < "$C"
if [ $B -lt 0 ] || [ $B -ge ${#D[@]} ];then echo "–ù–µ–≤–µ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏";return 1;fi;local F="${D[$B]}";echo "–£–¥–∞–ª–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: $F";read -p "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ (y/N): " G;if echo "$G" | grep -q '^[Yy]$';then > "$C.tmp"
for H in "${!D[@]}";do if [ $H -ne $B ];then echo "${D[$H]}" >> "$C.tmp";fi;done;mv "$C.tmp" "$C";local I="$m/$A.project";local J=$((${#D[@]} - 1));sed -i "s/^dirs_count=.*/dirs_count=$J/" "$I";echo -e "${o}‚úì –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞${x}"
else echo "–û—Ç–º–µ–Ω–µ–Ω–æ";fi;}
bR(){ local A="$1";local B="$2";local C="$m/$A.dbs";if [ ! -f "$C" ];then echo "–£ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–µ—Ç –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö";return 1;fi;local D=();while IFS= read -r E || [ -n "$E" ];do if [ -n "$E" ];then D+=("$E");fi;done < "$C"
if [ $B -lt 0 ] || [ $B -ge ${#D[@]} ];then echo "–ù–µ–≤–µ—Ä–Ω—ã–π –∏–Ω–¥–µ–∫—Å –ë–î";return 1;fi;IFS='|' read -r F G H I J K <<< "${D[$B]}";echo "–£–¥–∞–ª–µ–Ω–∏–µ –ë–î: $F ‚Üí $G";read -p "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ (y/N): " L;if echo "$L" | grep -q '^[Yy]$';then > "$C.tmp"
for M in "${!D[@]}";do if [ $M -ne $B ];then echo "${D[$M]}" >> "$C.tmp";fi;done;mv "$C.tmp" "$C";local N="$m/$A.project";local O=$((${#D[@]} - 1));sed -i "s/^dbs_count=.*/dbs_count=$O/" "$N";echo -e "${o}‚úì –ë–î —É–¥–∞–ª–µ–Ω–∞${x}";else echo "–û—Ç–º–µ–Ω–µ–Ω–æ";fi;}
bS(){ local A="$1";local B=$(bf "$A");if [ -z "$B" ];then echo -e "${n}–ü—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω${x}";return 1;fi;while true;do clear;echo -e "${o}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${x}"
echo -e "${o}‚ïë           –†–ï–î–ê–ö–¢–ò–†–û–í–ê–ù–ò–ï –ü–†–û–ï–ö–¢–ê: $B           ‚ïë${x}";echo -e "${o}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${x}";echo "";bJ "$A";echo -e "${q}–î–µ–π—Å—Ç–≤–∏—è:${x}";echo "";echo "  1) –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞";echo "  2) –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–µ–∫—Ç"
echo "  3) –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ";echo "  4) –î–æ–±–∞–≤–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏";echo "  5) –£–¥–∞–ª–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏";echo "  6) –î–æ–±–∞–≤–∏—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö";echo "  7) –£–¥–∞–ª–∏—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö";echo "  8) –ù–∞–π—Ç–∏ –ø–∞—Ä–æ–ª–∏ –¥–ª—è –ë–î";echo -e "${n}  9) –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç${x}";echo -e "${p}  0) –ù–∞–∑–∞–¥${x}";echo ""
read -p "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ [0-9]: " C;case $C in 1) read -p "–ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ [$B]: " D;if [ -n "$D" ];then local E=($(bg));local F=false;for G in "${E[@]}";do if [ "$G" != "$A" ] && [ "$(bf "$G")" = "$D" ];then F=true;break;fi;done
if [ "$F" = false ];then local H="$m/$A.project";sed -i "s/^name=.*/name=$D/" "$H";B="$D";echo -e "${o}‚úì –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–æ${x}";bF;else echo -e "${n}–ü—Ä–æ–µ–∫—Ç —Å —Ç–∞–∫–∏–º –Ω–∞–∑–≤–∞–Ω–∏–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç${x}";fi;fi ;;
2) local I="$m/$A.project";local J=$(grep '^enabled=' "$I" | cut -d'=' -f2);if [ "$J" = "true" ];then sed -i "s/^enabled=.*/enabled=false/" "$I";echo -e "${p}‚ö† –ü—Ä–æ–µ–∫—Ç –≤—ã–∫–ª—é—á–µ–Ω${x}";else sed -i "s/^enabled=.*/enabled=true/" "$I"
echo -e "${o}‚úì –ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–µ–Ω${x}";fi;bF ;;
3) bL "$A";bF ;;
4) bM "$A";bF ;;
5) bT "$A";bF ;;
6) bN "$A";bF ;;
7) bU "$A";bF ;;
8) bV "$A";bF ;;
9) echo -e "${n}–í–ù–ò–ú–ê–ù–ò–ï: –ü—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏!${x}";read -p "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ (y/N): " K;if echo "$K" | grep -q '^[Yy]$';then bP "$A";bF;return 1;fi ;;
0) return 0 ;;
*) echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!${x}" ;;esac;if [ $C -ne 9 ];then read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";fi;done;}
bT(){ local A="$1";local B=$(bf "$A");local C=$(bn "$A");if [ $C -eq 0 ];then echo -e "${p}–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π${x}";return;fi;echo "";echo -e "${s}=== –£–î–ê–õ–ï–ù–ò–ï –î–ò–†–ï–ö–¢–û–†–ò–ô –ò–ó –ü–†–û–ï–ö–¢–ê: $B ===${x}";echo "";local D="$m/$A.dirs";local E=1
while IFS= read -r F || [ -n "$F" ];do if [ -n "$F" ];then echo "  $E) $F";E=$((E + 1));fi;done < "$D";echo "";read -p "–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (0 –¥–ª—è –æ—Ç–º–µ–Ω—ã): " G
if echo "$G" | grep -q '^[0-9]\+$' && [ $G -ge 1 ] && [ $G -le $C ];then bQ "$A" $((G-1));echo -e "${o}‚úì –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞${x}";elif [ "$G" != "0" ];then echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä${x}";fi;}
bU(){ local A="$1";local B=$(bf "$A");local C=$(bo "$A");if [ $C -eq 0 ];then echo -e "${p}–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ—Ç –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö${x}";return;fi;echo "";echo -e "${s}=== –£–î–ê–õ–ï–ù–ò–ï –ë–ê–ó –î–ê–ù–ù–´–• –ò–ó –ü–†–û–ï–ö–¢–ê: $B ===${x}";echo "";local D="$m/$A.dbs";local E=1
while IFS= read -r F || [ -n "$F" ];do if [ -n "$F" ];then IFS='|' read -r G H I J K L <<< "$F";echo "  $E) $G ‚Üí $H";E=$((E + 1));fi;done < "$D";echo "";read -p "–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –ë–î –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è (0 –¥–ª—è –æ—Ç–º–µ–Ω—ã): " M
if echo "$M" | grep -q '^[0-9]\+$' && [ $M -ge 1 ] && [ $M -le $C ];then bR "$A" $((M-1));echo -e "${o}‚úì –ë–î —É–¥–∞–ª–µ–Ω–∞ –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞${x}";elif [ "$M" != "0" ];then echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä${x}";fi;}
bV(){ local A="$1";local B=$(bf "$A");local C=$(bo "$A");if [ $C -eq 0 ];then echo -e "${p}–í –ø—Ä–æ–µ–∫—Ç–µ –Ω–µ—Ç –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö${x}";return;fi;echo "";echo -e "${s}=== –ü–û–ò–°–ö –ü–ê–†–û–õ–ï–ô –î–õ–Ø –ë–ê–ó –î–ê–ù–ù–´–• –ü–†–û–ï–ö–¢–ê: $B ===${x}";local D="$m/$A.dbs";local E=0;local F=()
while IFS= read -r G || [ -n "$G" ];do if [ -z "$G" ];then continue;fi;IFS='|' read -r H I J K L M <<< "$G";echo "";echo -e "${q}–ë–î: $H ‚Üí $I${x}";if [ -n "$K" ] && [ "$L" != "none" ];then echo -e "  ${o}‚úì –£–∂–µ –µ—Å—Ç—å –ø–∞—Ä–æ–ª—å ($L)${x}";F+=("$G");continue;fi
local N=$(aM "$H" "$I" "$J");if [ -n "$N" ];then F+=("$H|$I|$J|$N|env|$M");E=$((E + 1));echo -e "  ${o}‚úì –ù–∞–π–¥–µ–Ω –ø–∞—Ä–æ–ª—å –≤ .env${x}";else F+=("$G");echo -e "  ${p}‚ö† –ü–∞—Ä–æ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω${x}";fi;done < "$D";> "$D";for O in "${F[@]}";do echo "$O" >> "$D";done
if [ $E -gt 0 ];then echo "";echo -e "${o}‚úì –ù–∞–π–¥–µ–Ω–æ $E –ø–∞—Ä–æ–ª–µ–π${x}";else echo "";echo -e "${p}‚ö† –ü–∞—Ä–æ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã${x}";fi;}
bW(){ echo "";echo -e "${s}=== –ê–í–¢–û–ü–û–ò–°–ö –ü–†–û–ï–ö–¢–û–í –í /opt ===${x}";if [ ! -d "/opt" ];then echo -e "${p}–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è /opt –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç${x}";return 0;fi;if [ ! -r "/opt" ];then echo -e "${p}–ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —á—Ç–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ /opt${x}";return 0;fi
echo -e "${q}–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ /opt...${x}";local A=($(find /opt -maxdepth 4 -type f -name ".env" -exec dirname {} \; 2>/dev/null | sort -u));if [ ${#A[@]} -eq 0 ];then echo -e "${p}–ù–µ –Ω–∞–π–¥–µ–Ω–æ –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å .env —Ñ–∞–π–ª–∞–º–∏ –≤ /opt${x}";return 0;fi
echo -e "${o}–ù–∞–π–¥–µ–Ω–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π —Å .env: ${#A[@]}${x}";echo "";local B=0;local C=($(docker ps --format "{{.Names}}" 2>/dev/null));for D in "${A[@]}";do local E=false;for F in "${A[@]}";do if [ "$D" != "$F" ] && [[ "$D" == "$F"/* ]];then E=true;break;fi;done
if [ "$E" = true ];then continue;fi;if [ ! -d "$D" ];then continue;fi;local G=$(basename "$D");local H="$G";if [ -f "$D/docker-compose.yml" ] || [ -f "$D/docker-compose.yaml" ];then local I="$D/docker-compose.yml"
[ ! -f "$I" ] && I="$D/docker-compose.yaml";if [ -f "$I" ];then local J=$(grep -E "^[[:space:]]*container_name:[[:space:]]*" "$I" | head -1 | sed 's/.*container_name:[[:space:]]*//' | tr -d '[:space:]')
if [ -n "$J" ];then H=$(echo "$J" | sed 's/[-_]//g');fi;fi;fi;local K=false;local L=($(bg));for M in "${L[@]}";do if [ "$(bf "$M")" = "$H" ];then K=true;break;fi;done;if [ "$K" = false ];then echo -e "  ${o}–°–æ–∑–¥–∞–µ–º –ø—Ä–æ–µ–∫—Ç: $H${x}";echo -e "    üìÅ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è: $D"
local N=$(bi "$H");bj "$N" "$D";br "$N" "0 2 * * *";echo -e "    ‚è≤Ô∏è  –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: –µ–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 2:00";local O="$D/.env";if [ -f "$O" ];then echo -e "    ${q}–ê–Ω–∞–ª–∏–∑ .env —Ñ–∞–π–ª–∞...${x}";local P=$(aJ "$O");local Q=$(aI "$O");local R=$(aK "$O")
echo -e "    ${q}–ù–∞–π–¥–µ–Ω–æ –≤ .env: DB=$P, USER=$Q${x}";if [ -n "$P" ] && [ -n "$Q" ];then local S="";for T in "${C[@]}";do local U=$(docker inspect --format '{{.Config.Image}}' "$T" 2>/dev/null | grep -i "postgres")
if [ -n "$U" ];then echo -e "    ${q}–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ $T...${x}";local V=false;if [ -n "$R" ];then if timeout 5 docker exec -e PGPASSWORD="$R" "$T" psql -U "$Q" -lqt 2>/dev/null | grep -q "\b$P\b";then V=true;fi
else if timeout 5 docker exec "$T" psql -U "$Q" -lqt 2>/dev/null | grep -q "\b$P\b";then V=true;fi;fi;if [ "$V" = true ];then S="$T";break;fi;fi;done;if [ -n "$S" ];then echo -e "    ${o}‚úì –î–æ–±–∞–≤–ª—è–µ–º –ë–î: $S ‚Üí $P${x}";bk "$N" "$S" "$P" "$Q" "$R" "env"
else echo -e "    ${p}‚ö† –ù–µ –Ω–∞–π–¥–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ë–î: $P${x}";fi;else echo -e "    ${p}‚ö† –í .env —Ñ–∞–π–ª–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã DB_NAME –∏–ª–∏ DB_USER${x}";fi;fi;B=$((B + 1));echo "";else echo -e "  ${p}–ü—Ä–æ–µ–∫—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: $H${x}";fi;done
if [ $B -gt 0 ];then bF;echo -e "${o}‚úì –°–æ–∑–¥–∞–Ω–æ $B –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤${x}";else echo -e "${p}–ù–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ${x}";fi;return $B;}
bX(){ while true;do clear;echo -e "${o}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${x}";echo -e "${o}‚ïë                –ú–ï–ù–ï–î–ñ–ï–† –ü–†–û–ï–ö–¢–û–í                        ‚ïë${x}"
echo -e "${o}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${x}";echo "";bO;echo -e "${q}–î–µ–π—Å—Ç–≤–∏—è:${x}";echo "";echo "  1) –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç";echo "  2) –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç";echo "  3) –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–µ–∫—Ç–µ";echo "  4) –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–µ–∫—Ç"
echo "  5) –ê–≤—Ç–æ–ø–æ–∏—Å–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ /opt";echo "  6) –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è–º–∏";echo -e "${p}  0) –ù–∞–∑–∞–¥${x}";echo "";read -p "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ [0-6]: " A;case $A in 1) bK;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
2) local B=($(bg));if [ ${#B[@]} -eq 0 ];then echo -e "${p}–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è${x}";read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";continue;fi;bO;read -p "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è [1-${#B[@]}]: " C
if echo "$C" | grep -q '^[0-9]\+$' && [ $C -ge 1 ] && [ $C -le ${#B[@]} ];then local D=$((C-1));local E="${B[$D]}";bS "$E";else echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä${x}";sleep 1;fi ;;
3) local F=($(bg));if [ ${#F[@]} -eq 0 ];then echo -e "${p}–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞${x}";read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";continue;fi;bO;read -p "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ [1-${#F[@]}]: " G
if echo "$G" | grep -q '^[0-9]\+$' && [ $G -ge 1 ] && [ $G -le ${#F[@]} ];then local H=$((G-1));local I="${F[$H]}";bJ "$I";read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";else echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä${x}";sleep 1;fi ;;
4) local J=($(bg));if [ ${#J[@]} -eq 0 ];then echo -e "${p}–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è${x}";read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";continue;fi;bO;read -p "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è [1-${#J[@]}]: " K
if echo "$K" | grep -q '^[0-9]\+$' && [ $K -ge 1 ] && [ $K -le ${#J[@]} ];then local L=$((K-1));local M="${J[$L]}";local N=$(bf "$M");echo -e "${n}–í–ù–ò–ú–ê–ù–ò–ï: –ü—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏!${x}"
echo -e "${o}–î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –∏ –ë–î –æ—Å—Ç–∞–Ω—É—Ç—Å—è –Ω–∞ –¥–∏—Å–∫–µ/–≤ Docker.${x}";read -p "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ (y/N): " O;if echo "$O" | grep -q '^[Yy]$';then bP "$M";bF;fi;else echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä${x}";fi;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
5) bW;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
6) bY ;;
0) return ;;
*) echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!${x}";sleep 1 ;;esac;done;}
bY(){ while true;do clear;echo -e "${o}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${x}";echo -e "${o}‚ïë                –£–ü–†–ê–í–õ–ï–ù–ò–ï –†–ê–°–ü–ò–°–ê–ù–ò–Ø–ú–ò                  ‚ïë${x}"
echo -e "${o}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${x}";echo "";echo -e "${s}–ü—Ä–æ–µ–∫—Ç—ã —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è–º–∏:${x}";echo "";local A=($(by));if [ ${#A[@]} -eq 0 ];then echo -e "${p}–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è–º–∏${x}"
else local B=1;for C in "${A[@]}";do local D=$(bf "$C");local E=$(bt "$C");local F=$(bu "$C" && echo "true" || echo "false");local G=$(bp "$C" && echo "true" || echo "false");local H="";if [ "$G" = "true" ];then H="${o}‚úì${x}";else H="${n}‚úó${x}";fi
local I="";if [ "$F" = "true" ];then I="${o}‚úì${x}";else I="${n}‚úó${x}";fi;printf " %2d) %-25s %s | %s %s\n" "$B" "$D" "$E" "$H" "$I";B=$((B + 1));done;fi;echo "";echo -e "${q}–î–µ–π—Å—Ç–≤–∏—è:${x}";echo "";echo "  1) –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞"
echo "  2) –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞";echo "  3) –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ cron –∑–∞–¥–∞–Ω–∏—è";echo "  4) –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ cron –∑–∞–¥–∞–Ω–∏—è";echo "  5) –£–¥–∞–ª–∏—Ç—å –≤—Å–µ cron –∑–∞–¥–∞–Ω–∏—è";echo "  6) –¢–µ—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é";echo -e "${p}  0) –ù–∞–∑–∞–¥${x}";echo ""
read -p "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ [0-6]: " J;case $J in 1) local K=($(bg));if [ ${#K[@]} -eq 0 ];then echo -e "${p}–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤${x}";read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";continue;fi;bO
read -p "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è [1-${#K[@]}]: " L;if echo "$L" | grep -q '^[0-9]\+$' && [ $L -ge 1 ] && [ $L -le ${#K[@]} ];then local M=$((L-1));local N="${K[$M]}";bL "$N";bF;fi ;;
2) local O=($(by));if [ ${#O[@]} -eq 0 ];then echo -e "${p}–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è–º–∏${x}";read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";continue;fi;echo "";local P=1;for Q in "${O[@]}";do local R=$(bf "$Q");printf " %2d) %s\n" "$P" "$R";P=$((P + 1));done
echo "";read -p "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç [1-${#O[@]}]: " S;if echo "$S" | grep -q '^[0-9]\+$' && [ $S -ge 1 ] && [ $S -le ${#O[@]} ];then local T=$((S-1));local U="${O[$T]}";local V="$m/$U.schedule";if [ -f "$V" ];then local W=$(head -1 "$V")
IFS='|' read -r X Y Z <<< "$W";if [ "$Y" = "true" ];then sed -i "1s/|true|/|false|/" "$V";echo -e "${p}‚úì –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–æ${x}";else sed -i "1s/|false|/|true|/" "$V";echo -e "${o}‚úì –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ${x}";fi;bF;fi;fi ;;
3) bB;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
4) bD;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
5) echo -e "${n}–í–ù–ò–ú–ê–ù–ò–ï: –í—Å–µ cron –∑–∞–¥–∞–Ω–∏—è backup-rebel –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã!${x}";read -p "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ —É–¥–∞–ª–µ–Ω–∏–µ (y/N): " a0;if echo "$a0" | grep -q '^[Yy]$';then bC;fi;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
6) bZ ;;
0) return ;;
*) echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!${x}";sleep 1 ;;esac;done;}
bZ(){ echo "";echo -e "${s}=== –¢–ï–°–¢ –í–´–ü–û–õ–ù–ï–ù–ò–Ø –ü–û –†–ê–°–ü–ò–°–ê–ù–ò–Æ ===${x}";echo "";local A=($(by));local B=$(date '+%Y-%m-%d %H:%M:%S');local C=$(date +%M);local D=$(date +%H);local E=$(date +%d);local F=$(date +%m);local G=$(date +%u)
local H=$((G % 7));echo "–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: $B";echo "–î–µ—Ç–∞–ª–∏: —á–∞—Å=$D, –º–∏–Ω—É—Ç–∞=$C, –¥–µ–Ω—å=$E, –º–µ—Å—è—Ü=$F, –¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏=$H";echo "";if [ ${#A[@]} -eq 0 ];then echo -e "${p}–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è–º–∏${x}";return;fi;local I=0
for J in "${A[@]}";do local K=$(bf "$J");local L=$(bt "$J");echo -e "${q}–ü—Ä–æ–µ–∫—Ç: $K${x}";echo "  –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: $L";IFS=' ' read -r M N O P Q <<< "$L";echo "  –†–∞–∑–±–æ—Ä: –º–∏–Ω=$M —á–∞—Å=$N –¥–µ–Ω—å=$O –º–µ—Å—è—Ü=$P –¥–µ–Ω—å_–Ω–µ–¥–µ–ª–∏=$Q";if bz "$J";then echo -e "  ${o}‚úì –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω –±—ç–∫–∞–ø –°–ï–ô–ß–ê–°${x}"
I=$((I + 1));else echo -e "  ${p}‚úó –ù–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω —Å–µ–π—á–∞—Å${x}";fi;echo "";done;if [ $I -gt 0 ];then echo -e "${o}–ò—Ç–æ–≥–æ: $I –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–±—ç–∫–∞–ø–ª–µ–Ω—ã —Å–µ–π—á–∞—Å${x}";read -p "–ó–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫–∞–ø –¥–ª—è —ç—Ç–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å–µ–π—á–∞—Å? (y/N): " R;if echo "$R" | grep -q '^[Yy]$';then echo "";echo "–ó–∞–ø—É—Å–∫ –±—ç–∫–∞–ø–∞..."
for S in "${A[@]}";do if bz "$S";then local T=$(bf "$S");echo -e "${o}–ë—ç–∫–∞–ø –ø—Ä–æ–µ–∫—Ç–∞: $T${x}";ca "$S" "$T";echo "";fi;done;fi;else echo -e "${p}–ò—Ç–æ–≥–æ: –Ω–∏ –æ–¥–∏–Ω –ø—Ä–æ–µ–∫—Ç –Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–±—ç–∫–∞–ø–ª–µ–Ω —Å–µ–π—á–∞—Å${x}";echo "";echo -e "${s}–°–æ–≤–µ—Ç—ã:${x}";echo "‚Ä¢ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤–∫–ª—é—á–µ–Ω–æ"
echo "‚Ä¢ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–µ–Ω";echo "‚Ä¢ –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º";echo "‚Ä¢ –ü—Ä–∏–º–µ—Ä: –¥–ª—è —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è '0 2 * * *' —Ç–µ—Å—Ç –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –≤ 02:00";fi;}
ca(){ local A="$1";local B="$2";if [ ! -f "$m/$A.project" ];then ax "ERROR" "–ü—Ä–æ–µ–∫—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω: $A";return 1;fi;if ! bp "$A";then ax "INFO" "–ü—Ä–æ–µ–∫—Ç –æ—Ç–∫–ª—é—á–µ–Ω: $B";return 0;fi;ax "PROJECT" "–ù–∞—á–∏–Ω–∞–µ–º –±—ç–∫–∞–ø –ø—Ä–æ–µ–∫—Ç–∞: $B"
local C="$j/projects/$B";mkdir -p "$C";local D=$(date +%Y%m%d_%H%M%S);local E="${B}_${D}";local F="$j/projects/$B/$E";mkdir -p "$F";local G=true;local H=0;local I=0;local J=();ax "PROJECT" "–ë—ç–∫–∞–ø –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –ø—Ä–æ–µ–∫—Ç–∞: $B";local K=();local L="$m/$A.dirs"
if [ -f "$L" ] && [ -s "$L" ];then while IFS= read -r M || [ -n "$M" ];do if [ -z "$M" ];then continue;fi;if [ ! -d "$M" ];then ax "WARNING" "–î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: $M";continue;fi;local N=$(basename "$M");local O=$(echo "$N" | sed 's/[^a-zA-Z0-9._-]/_/g')
local P="dir_${O}_${D}.tar.gz";local Q="$F/$P";ax "INFO" "–ê—Ä—Ö–∏–≤–∏—Ä—É–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: $M";if tar -czf "$Q" -C "$(dirname "$M")" "$N" 2>/dev/null;then local R=$(aA "$Q");local S=$(aB "$R");ax "SUCCESS" "‚úì –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∞: $P ($S)";K+=("$Q");J+=("$Q")
H=$((H + 1));else ax "ERROR" "‚úó –û—à–∏–±–∫–∞ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: $M";G=false;fi;done < "$L";else ax "PROJECT" "–ù–µ—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è –±—ç–∫–∞–ø–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ $B";fi;ax "DB" "–ë—ç–∫–∞–ø –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞: $B";local T=();local U="$m/$A.dbs"
if [ -f "$U" ] && [ -s "$U" ];then while IFS= read -r V || [ -n "$V" ];do if [ -z "$V" ];then continue;fi;IFS='|' read -r W X Y Z a0 a1 <<< "$V";if [ -z "$W" ] || [ -z "$X" ] || [ -z "$Y" ];then ax "ERROR" "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ë–î: $V";continue;fi
local a2=$(echo "$W" | sed 's/[^a-zA-Z0-9._-]/_/g');local a3=$(echo "$X" | sed 's/[^a-zA-Z0-9._-]/_/g');local a4="db_${a2}_${a3}_${D}.sql.gz";local a5="$F/$a4";ax "DB" "–î–∞–º–ø –ë–î: $W ‚Üí $X";local a6="";if [ -n "$Z" ];then a6="docker exec -e PGPASSWORD='$Z' '$W' pg_dump -U '$Y' '$X' 2>/dev/null"
else a6="docker exec '$W' pg_dump -U '$Y' '$X' 2>/dev/null";fi;if eval "$a6" | gzip > "$a5";then local a7=$(aA "$a5");local a8=$(aB "$a7");ax "SUCCESS" "‚úì –ë–î –∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∞: $a4 ($a8)";T+=("$a5");J+=("$a5");I=$((I + 1));else ax "ERROR" "‚úó –û—à–∏–±–∫–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞ –ë–î: $W ‚Üí $X";G=false;fi;done < "$U"
else ax "DB" "–ù–µ—Ç –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –±—ç–∫–∞–ø–∞ –≤ –ø—Ä–æ–µ–∫—Ç–µ $B";fi;local a9="$F/backup.meta";{ echo "project_id=$A";echo "project_name=$B";echo "timestamp=$D";echo "date=$(date '+%Y-%m-%d %H:%M:%S')";echo "directories_count=$H";echo "databases_count=$I"
echo "directories_backup_files=${#K[@]}";echo "databases_backup_files=${#T[@]}";} > "$a9";local ba="${B}_${D}.tar.gz";local bb="$C/$ba";ax "INFO" "–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—â–µ–≥–æ –∞—Ä—Ö–∏–≤–∞ –ø—Ä–æ–µ–∫—Ç–∞...";ax "INFO" "–î–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–æ: $H";ax "INFO" "–ë–î –∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–æ: $I"
if [ ${#J[@]} -gt 0 ];then ax "INFO" "–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –∏–∑ ${#J[@]} —Ñ–∞–π–ª–æ–≤...";cd "$(dirname "$F")" 2>/dev/null || { ax "ERROR" "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–π—Ç–∏ –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é";return 1;};ax "DEBUG" "–°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞: tar -czf \"$bb\" \"$(basename "$F")\""
if tar -czf "$bb" "$(basename "$F")" 2>/dev/null;then sleep 1;if [ ! -f "$bb" ];then ax "ERROR" "–ê—Ä—Ö–∏–≤ –Ω–µ —Å–æ–∑–¥–∞–Ω: $bb";return 1;fi;if [ ! -r "$bb" ];then ax "ERROR" "–ê—Ä—Ö–∏–≤ –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —á—Ç–µ–Ω–∏—è";return 1;fi
ax "DEBUG" "–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞: $(basename "$bb")";local bc=$(aA "$bb");ax "DEBUG" "–°—ã—Ä—ã–µ –±–∞–π—Ç—ã: $bc";if ! [[ "$bc" =~ ^[0-9]+$ ]];then ax "ERROR" "–û—à–∏–±–∫–∞: –ø–æ–ª—É—á–µ–Ω–æ –Ω–µ—á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞: '$bc'";return 1;fi
local bd=$(aB "$bc");ax "DEBUG" "–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–æ: $bd";if [ "$bc" -eq 0 ];then ax "ERROR" "–û—à–∏–±–∫–∞: –∞—Ä—Ö–∏–≤ –∏–º–µ–µ—Ç –Ω—É–ª–µ–≤–æ–π —Ä–∞–∑–º–µ—Ä";return 1;fi;ax "SUCCESS" "‚úì –ü—Ä–æ–µ–∫—Ç –∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω: $ba ($bd)";rm -rf "$F";echo "$(realpath "$bb" 2>/dev/null || echo "$bb")";return 0
else ax "ERROR" "‚úó –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∞—Ä—Ö–∏–≤–∞ –ø—Ä–æ–µ–∫—Ç–∞";ax "DEBUG" "–ö–æ–¥ –æ—à–∏–±–∫–∏: $?";return 1;fi;else ax "WARNING" "–ù–µ—Ç —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏";cd "$(dirname "$F")" 2>/dev/null;if tar -czf "$bb" "$(basename "$F")" 2>/dev/null;then local bc=$(aA "$bb");local bd=$(aB "$bc")
ax "SUCCESS" "‚úì –ü—É—Å—Ç–æ–π –∞—Ä—Ö–∏–≤ —Å–æ–∑–¥–∞–Ω: $ba ($bd)";rm -rf "$F";ax "DEBUG" "–ü—É—Å—Ç–æ–π –∞—Ä—Ö–∏–≤ —Å–æ–∑–¥–∞–Ω: $bb";ax "DEBUG" "–§–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: $(if [ -f "$bb" ];then echo "–î–ê";else echo "–ù–ï–¢";fi)";echo "$(realpath "$bb")";return 0;else ax "ERROR" "‚úó –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏–≤";return 1;fi;fi;}
cb(){ local A="$1";local B=$(bf "$A");if [ -z "$B" ];then ax "ERROR" "–ü—Ä–æ–µ–∫—Ç —Å ID $A –Ω–µ –Ω–∞–π–¥–µ–Ω";return 1;fi;ax "CRON" "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é: $B";local C;if C=$(ca "$A" "$B");then ax "SUCCESS" "‚úì –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø –∑–∞–≤–µ—Ä—à–µ–Ω: $B"
local D=$(tail -50 "$k" 2>/dev/null);if [ "$Y" = "true" ] && [ "$ae" = "true" ];then local E=$(hostname 2>/dev/null || echo "unknown");local F=$(date '+%Y-%m-%d %H:%M:%S');local G="<b>ü§ñ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –ë–≠–ö–ê–ü</b>"
G="${G}"$'\n'"";G="${G}"$'\n'"<b>–•–æ—Å—Ç:</b> <code>$E</code>";G="${G}"$'\n'"<b>–î–∞—Ç–∞:</b> <code>$F</code>";G="${G}"$'\n'"<b>–ü—Ä–æ–µ–∫—Ç:</b> <code>$B</code>";G="${G}"$'\n'"<b>–¢–∏–ø:</b> üîÑ –ü–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é";G="${G}"$'\n'"";G="${G}"$'\n'"<b>–°—Ç–∞—Ç—É—Å:</b> ‚úÖ <b>–ë–≠–ö–ê–ü –í–´–ü–û–õ–ù–ï–ù –£–°–ü–ï–®–ù–û</b>"
aW "$G";if [ "$ac" = "true" ] && [ -f "$C" ];then local H=$(aA "$C");local I=$(aB "$H");local J="<b>üì¶ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –ë–≠–ö–ê–ü: $B</b>";J="${J}"$'\n'"";J="${J}"$'\n'"<b>–•–æ—Å—Ç:</b> <code>$E</code>";J="${J}"$'\n'"<b>–î–∞—Ç–∞:</b> <code>$F</code>"
J="${J}"$'\n'"<b>–†–∞–∑–º–µ—Ä:</b> <code>$I</code>";J="${J}"$'\n'"";J="${J}"$'\n'"<i>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é</i>";aX "$C" "$J";fi;fi;if [ "$aj" = "true" ] && [ "$av" = "true" ];then local K="–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ"
aT "$B" "$C" true "$K" "$D";fi;return 0;else ax "ERROR" "‚úó –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±—ç–∫–∞–ø–∞: $B";local D=$(tail -50 "$k" 2>/dev/null);if [ "$Y" = "true" ] && [ "$af" = "true" ];then local E=$(hostname 2>/dev/null || echo "unknown")
local F=$(date '+%Y-%m-%d %H:%M:%S');local G="<b>ü§ñ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –ë–≠–ö–ê–ü - –û–®–ò–ë–ö–ê</b>";G="${G}"$'\n'"";G="${G}"$'\n'"<b>–•–æ—Å—Ç:</b> <code>$E</code>";G="${G}"$'\n'"<b>–î–∞—Ç–∞:</b> <code>$F</code>";G="${G}"$'\n'"<b>–ü—Ä–æ–µ–∫—Ç:</b> <code>$B</code>"
G="${G}"$'\n'"<b>–¢–∏–ø:</b> üîÑ –ü–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é";G="${G}"$'\n'"";G="${G}"$'\n'"<b>–°—Ç–∞—Ç—É—Å:</b> ‚ùå <b>–û–®–ò–ë–ö–ê –í–´–ü–û–õ–ù–ï–ù–ò–Ø –ë–≠–ö–ê–ü–ê</b>";G="${G}"$'\n'"";G="${G}"$'\n'"<i>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</i>";aW "$G";fi
if [ "$aj" = "true" ] && [ "$aw" = "true" ];then local K="–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±—ç–∫–∞–ø–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é";aT "$B" "" false "$K" "$D";fi;return 1;fi;}
cc(){ ax "INFO" "–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤ (—Å—Ç–∞—Ä—à–µ $l –¥–Ω–µ–π)";local A=0;local B=0;find "$j" -name "*.tar.gz" -type f -mtime +$l | while read -r C;do if rm -f "$C";then local D=$(basename "$C");ax "INFO" "–£–¥–∞–ª–µ–Ω —Å—Ç–∞—Ä—ã–π –±—ç–∫–∞–ø: $D";A=$((A + 1))
else ax "ERROR" "–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å: $C";B=$((B + 1));fi;done;ax "SUCCESS" "–û—á–∏—Å—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –£–¥–∞–ª–µ–Ω–æ: $A —Ñ–∞–π–ª–æ–≤, –æ—à–∏–±–æ–∫: $B";echo "$A";}
cd(){ ax "INFO" "–ù–∞—á–∏–Ω–∞–µ–º –±—ç–∫–∞–ø –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤";local A=($(bg));local B=${#A[@]};local C=0;local D=0;local E=0;local F=();local G=$(date +%s);for H in "${A[@]}";do local I=$(bf "$H");if ! bp "$H";then ax "INFO" "–ü—Ä–æ–ø—É—Å–∫–∞–µ–º –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç: $I"
E=$((E + 1));continue;fi;ax "PROJECT" "–ë—ç–∫–∞–ø –ø—Ä–æ–µ–∫—Ç–∞ ($((C + D + 1))/$B): $I";local J;if J=$(ca "$H" "$I");then ax "SUCCESS" "‚úì –ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–±—ç–∫–∞–ø–ª–µ–Ω: $I";F+=("$J");C=$((C + 1));else ax "ERROR" "‚úó –û—à–∏–±–∫–∞ –±—ç–∫–∞–ø–∞ –ø—Ä–æ–µ–∫—Ç–∞: $I";D=$((D + 1));fi;echo "";done
local K=$(date +%s);local L=$((K - G));local M=$(tail -100 "$k" 2>/dev/null);if [ "$Y" = "true" ];then local N=$(hostname 2>/dev/null || echo "unknown");local O=$(date '+%Y-%m-%d %H:%M:%S');local P="<b>üìä –û–¢–ß–ï–¢ –û –ë–≠–ö–ê–ü–ï</b>"
P="${P}"$'\n'"";P="${P}"$'\n'"<b>–•–æ—Å—Ç:</b> <code>$N</code>";P="${P}"$'\n'"<b>–î–∞—Ç–∞:</b> <code>$O</code>";P="${P}"$'\n'"<b>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</b> $L —Å–µ–∫";P="${P}"$'\n'"";P="${P}"$'\n'"<b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</b>";P="${P}"$'\n'"‚úÖ <b>–£—Å–ø–µ—à–Ω–æ:</b> $C –ø—Ä–æ–µ–∫—Ç–æ–≤"
P="${P}"$'\n'"‚ùå <b>–û—à–∏–±–∫–∏:</b> $D –ø—Ä–æ–µ–∫—Ç–æ–≤";P="${P}"$'\n'"‚è≠Ô∏è  <b>–ü—Ä–æ–ø—É—â–µ–Ω–æ:</b> $E –ø—Ä–æ–µ–∫—Ç–æ–≤";P="${P}"$'\n'"üìÅ <b>–í—Å–µ–≥–æ:</b> $B –ø—Ä–æ–µ–∫—Ç–æ–≤";if [ ${#F[@]} -gt 0 ];then P="${P}"$'\n'"";P="${P}"$'\n'"<b>–°–æ–∑–¥–∞–Ω–Ω—ã–µ –∞—Ä—Ö–∏–≤—ã (${#F[@]}):</b>"
for Q in "${F[@]}";do local R=$(basename "$Q");local S=$(aA "$Q");local T=$(aB "$S");P="${P}"$'\n'"‚Ä¢ <code>$R</code> ($T)";done;fi;if [ $D -eq 0 ] && [ $C -gt 0 ];then P="${P}"$'\n'"";P="${P}"$'\n'"<b>–°—Ç–∞—Ç—É—Å:</b> ‚úÖ <b>–í–°–ï –ü–†–û–ï–ö–¢–´ –£–°–ü–ï–®–ù–û –ó–ê–ë–≠–ö–ê–ü–õ–ï–ù–´</b>"
elif [ $D -gt 0 ];then P="${P}"$'\n'"";P="${P}"$'\n'"<b>–°—Ç–∞—Ç—É—Å:</b> ‚ö†Ô∏è  <b>–ù–ï–ö–û–¢–û–†–´–ï –ü–†–û–ï–ö–¢–´ –ù–ï –ó–ê–ë–≠–ö–ê–ü–õ–ï–ù–´</b>";fi;aW "$P";if [ "$ac" = "true" ] && [ ${#F[@]} -gt 0 ];then ax "TELEGRAM" "–û—Ç–ø—Ä–∞–≤–∫–∞ ${#F[@]} —Ñ–∞–π–ª–æ–≤ –±—ç–∫–∞–ø–æ–≤ –≤ Telegram";ax "DEBUG" "–°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π:"
for U in "${!F[@]}";do local V="${F[$U]}";ax "DEBUG" "  [$U] $V";done;local W=();for X in "${F[@]}";do ax "DEBUG" "–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–∞: $(basename "$X")";if [ -f "$X" ];then local Y=$(aA "$X");if ! [[ "$Y" =~ ^[0-9]+$ ]];then ax "ERROR" "  –ù–µ—á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞: '$Y'";continue;fi
if [ "$Y" -gt 0 ];then W+=("$X");local Z=$(aB "$Y");ax "DEBUG" "  –§–∞–π–ª –¥–æ–±–∞–≤–ª–µ–Ω: $(basename "$X") ($Z)";else ax "ERROR" "  –§–∞–π–ª –∏–º–µ–µ—Ç –Ω—É–ª–µ–≤–æ–π —Ä–∞–∑–º–µ—Ä: $(basename "$X")";fi;else ax "ERROR" "  –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: $(basename "$X")";fi;done
ax "DEBUG" "–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏: ${#W[@]}";if [ ${#W[@]} -gt 0 ];then aZ "${W[@]}";else ax "ERROR" "–ù–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram";fi;fi;if [ $D -gt 0 ] && [ "$ac" = "true" ];then local a0="/tmp/backup_log_$(date +%s).txt"
echo "$M" > "$a0";aX "$a0" "–õ–æ–≥ –æ—à–∏–±–æ–∫ –±—ç–∫–∞–ø–∞";rm -f "$a0";fi;fi;if [ "$aj" = "true" ] && [ "$ar" = "true" ];then aU "$C" "$D" "$E" "$B" "${F[@]}" "$L";fi;echo "";echo -e "${o}–ë—ç–∫–∞–ø –∑–∞–≤–µ—Ä—à–µ–Ω!${x}";echo "–£—Å–ø–µ—à–Ω–æ: $C –ø—Ä–æ–µ–∫—Ç–æ–≤";echo "–û—à–∏–±–∫–∏: $D –ø—Ä–æ–µ–∫—Ç–æ–≤";echo "";return $D;}
ce(){ local A="$1";local B=();if [ -z "$A" ];then find "$j" -name "*.tar.gz" -type f 2>/dev/null | sort -r;else find "$j/projects/$A" -name "*.tar.gz" -type f 2>/dev/null | sort -r;fi;}
cf(){ local A="$1";local B=$(mktemp -d);tar -xzf "$A" -C "$B" --wildcards "*/backup.meta" 2>/dev/null;local C=$(find "$B" -name "backup.meta" -type f 2>/dev/null | head -1);local D="";if [ -f "$C" ];then local E=$(grep "^project_name=" "$C" | cut -d'=' -f2-)
local F=$(grep "^timestamp=" "$C" | cut -d'=' -f2-);local G=$(grep "^date=" "$C" | cut -d'=' -f2-);local H=$(grep "^directories_count=" "$C" | cut -d'=' -f2-);local I=$(grep "^databases_count=" "$C" | cut -d'=' -f2-)
D="${E}|${F}|${G}|${H}|${I}";else local J=$(basename "$A");local K=$(echo "$J" | sed 's/_.*//');D="${K}|||0|0";fi;rm -rf "$B";echo "$D";}
cg(){ local A="$1";echo "";echo -e "${s}=== –í–´–ë–û–† –ë–≠–ö–ê–ü–ê –î–õ–Ø –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–Ø ===${x}";if [ -z "$A" ];then echo "–ü–æ–∏—Å–∫ –≤—Å–µ—Ö –±—ç–∫–∞–ø–æ–≤...";local B=($(ce));else echo "–ü–æ–∏—Å–∫ –±—ç–∫–∞–ø–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞: $A";local B=($(ce "$A"));fi
if [ ${#B[@]} -eq 0 ];then echo -e "${p}–ë—ç–∫–∞–ø—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã${x}";echo "";return "";fi;echo "";echo -e "${o}–ù–∞–π–¥–µ–Ω–æ –±—ç–∫–∞–ø–æ–≤: ${#B[@]}${x}";echo "";local C=1;for D in "${B[@]}";do local E=$(cf "$D");IFS='|' read -r F G H I J <<< "$E"
local K=$(basename "$D");local L=$(aA "$D");local M=$(aB "$L");local N="$H";[ -z "$N" ] && N=$(stat -c "%y" "$D" 2>/dev/null | cut -d' ' -f1);printf " %2d) %-30s | üìÅ %2s | üóÑÔ∏è  %2s | %-10s | %s\n" "$C" "$F" "$I" "$J" "$M" "$N";C=$((C + 1));done
echo "";read -p "–í—ã–±–µ—Ä–∏—Ç–µ –±—ç–∫–∞–ø –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è [1-${#B[@]}]: " O;if echo "$O" | grep -q '^[0-9]\+$' && [ $O -ge 1 ] && [ $O -le ${#B[@]} ];then local P=$((O - 1));echo "${B[$P]}";else echo "";return "";fi;}
ch(){ local A="$1";local B="$2";ax "RESTORE" "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π...";local C="*_dir_*.tar.gz";tar -tzf "$A" 2>/dev/null | grep "$C" | while read -r D;do ax "INFO" "–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: $D";tar -xzf "$A" -C "$B" "$D" 2>/dev/null
local E="$B/$D";local F=$(echo "$D" | sed 's/^dir_//' | sed 's/_[0-9]\{8\}_[0-9]\{6\}\.tar\.gz$//');local G="";if [ -d "/opt/$F" ];then G="/opt/$F";ax "INFO" "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é: $G";else G="/opt/$F";mkdir -p "$(dirname "$G")"
ax "INFO" "–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: $G";fi;if tar -xzf "$E" -C "$(dirname "$G")" 2>/dev/null;then ax "SUCCESS" "‚úì –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: $G";else ax "ERROR" "‚úó –û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏: $F";fi;rm -f "$E";done;}
ci(){ local A="$1";local B="$2";ax "RESTORE" "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö...";local C="*_db_*.sql.gz";tar -tzf "$A" 2>/dev/null | grep "$C" | while read -r D;do ax "INFO" "–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–º–ø–∞ –ë–î: $D";tar -xzf "$A" -C "$B" "$D" 2>/dev/null
local E="$B/$D";local F=$(basename "$D" .sql.gz);local G=$(echo "$F" | cut -d'_' -f2);local H=$(echo "$F" | cut -d'_' -f3);local I="postgres";local J="";if docker ps --format "{{.Names}}" | grep -q "^${G}$";then ax "INFO" "–ù–∞–π–¥–µ–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä: $G"
J=$(aM "$G" "$H" "$I");ax "INFO" "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î: $H –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ $G";local K="";local L="";if [ -n "$J" ];then K="docker exec -e PGPASSWORD='$J' '$G' psql -U '$I' -c \"CREATE DATABASE $H;\" 2>/dev/null || true"
L="docker exec -i -e PGPASSWORD='$J' '$G' psql -U '$I' '$H' < <(gunzip -c '$E')";else K="docker exec '$G' psql -U '$I' -c \"CREATE DATABASE $H;\" 2>/dev/null || true";L="docker exec -i '$G' psql -U '$I' '$H' < <(gunzip -c '$E')";fi
eval "$K";if eval "$L" 2>/dev/null;then ax "SUCCESS" "‚úì –ë–î –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞: $H –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ $G";else ax "ERROR" "‚úó –û—à–∏–±–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ë–î: $H";fi;else ax "WARNING" "–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω: $G. –ë–î $H –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞.";fi;rm -f "$E";done;}
cj(){ local A="$1";if [ ! -f "$A" ];then ax "ERROR" "–§–∞–π–ª –±—ç–∫–∞–ø–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω: $A";return 1;fi;ax "RESTORE" "–ù–∞—á–∏–Ω–∞–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞: $(basename "$A")";local B=$(mktemp -d);local C=$(cf "$A")
IFS='|' read -r D E F G H <<< "$C";echo "";echo -e "${s}=== –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ë–≠–ö–ê–ü–ï ===${x}";echo "–ü—Ä–æ–µ–∫—Ç: $D";echo "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: $F";echo "–î–∏—Ä–µ–∫—Ç–æ—Ä–∏–π: $G";echo "–ë–∞–∑ –¥–∞–Ω–Ω—ã—Ö: $H";echo "";read -p "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ? (y/N): " I
if ! echo "$I" | grep -q '^[Yy]$';then ax "INFO" "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ";rm -rf "$B";return 1;fi;echo "";echo -e "${p}–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:${x}";echo "";local J="false";local K="false";if [ "$G" -gt 0 ];then read -p "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏? (Y/n): " L
if [ -z "$L" ] || echo "$L" | grep -q '^[Yy]$';then J="true";fi;fi;if [ "$H" -gt 0 ];then read -p "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö? (Y/n): " M;if [ -z "$M" ] || echo "$M" | grep -q '^[Yy]$';then K="true";fi;fi
if [ "$J" = "false" ] && [ "$K" = "false" ];then ax "INFO" "–ù–µ—á–µ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å";rm -rf "$B";return 1;fi;local N="$B/extract";mkdir -p "$N";ax "INFO" "–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –±—ç–∫–∞–ø–∞...";tar -xzf "$A" -C "$N" 2>/dev/null
local O=$(find "$N" -type d -name "*_*" 2>/dev/null | head -1);if [ -z "$O" ];then O="$N";fi;if [ "$J" = "true" ] && [ "$G" -gt 0 ];then ch "$A" "$O";else ax "INFO" "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –ø—Ä–æ–ø—É—â–µ–Ω–æ";fi
if [ "$K" = "true" ] && [ "$H" -gt 0 ];then ci "$A" "$O";else ax "INFO" "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –ø—Ä–æ–ø—É—â–µ–Ω–æ";fi;rm -rf "$B";ax "SUCCESS" "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ";if [ "$Y" = "true" ];then local P=$(hostname 2>/dev/null || echo "unknown")
local Q=$(date '+%Y-%m-%d %H:%M:%S');local R="<b>üîÑ –û–¢–ß–ï–¢ –û –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ò</b>";R="${R}"$'\n'"";R="${R}"$'\n'"<b>–•–æ—Å—Ç:</b> <code>$P</code>";R="${R}"$'\n'"<b>–î–∞—Ç–∞:</b> <code>$Q</code>";R="${R}"$'\n'"<b>–ü—Ä–æ–µ–∫—Ç:</b> <code>$D</code>";R="${R}"$'\n'""
R="${R}"$'\n'"<b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</b>";R="${R}"$'\n'"üìÅ <b>–î–∏—Ä–µ–∫—Ç–æ—Ä–∏–π:</b> $G";R="${R}"$'\n'"üóÑÔ∏è  <b>–ë–∞–∑ –¥–∞–Ω–Ω—ã—Ö:</b> $H";R="${R}"$'\n'"";R="${R}"$'\n'"<b>–°—Ç–∞—Ç—É—Å:</b> ‚úÖ <b>–í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –í–´–ü–û–õ–ù–ï–ù–û</b>";aW "$R";fi
if [ "$aj" = "true" ] && [ "$ar" = "true" ];then local S=$(tail -50 "$k" 2>/dev/null);local T="–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ –±—ç–∫–∞–ø–∞ –æ—Ç $F";aT "$D" "" true "$T" "$S";fi;return 0;}
ck(){ while true;do clear;echo -e "${o}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${x}";echo -e "${o}‚ïë                –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï –ü–†–û–ï–ö–¢–û–í                  ‚ïë${x}"
echo -e "${o}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${x}";echo "";echo -e "${s}–î–æ—Å—Ç—É–ø–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:${x}";echo "";local A=();if [ -d "$j/projects" ];then for B in "$j/projects"/*/;do [ ! -d "$B" ] && continue
local C=$(basename "$B" 2>/dev/null);[ -z "$C" ] && continue;local D=$(find "$B" -name "*.tar.gz" -type f 2>/dev/null | wc -l);if [ $D -gt 0 ];then A+=("$C");printf "  %-25s - %2d –±—ç–∫–∞–ø–æ–≤\n" "$C" "$D";fi;done;fi
if [ ${#A[@]} -eq 0 ];then echo -e "${p}–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ —Å –±—ç–∫–∞–ø–∞–º–∏${x}";echo "";echo "–í—ã –º–æ–∂–µ—Ç–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ –ª—é–±–æ–≥–æ –±—ç–∫–∞–ø–∞ –≤—Ä—É—á–Ω—É—é.";fi;echo "";echo -e "${q}–î–µ–π—Å—Ç–≤–∏—è:${x}";echo "";echo "  1) –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–µ–∫—Ç –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞"
echo "  2) –í—ã–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è";echo "  3) –í—ã–±—Ä–∞—Ç—å –±—ç–∫–∞–ø –≤—Ä—É—á–Ω—É—é";echo "  4) –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –±—ç–∫–∞–ø—ã";echo -e "${p}  0) –ù–∞–∑–∞–¥${x}";echo "";read -p "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ [0-4]: " E;case $E in 1) if [ ${#A[@]} -eq 0 ];then echo -e "${p}–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è${x}"
read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";continue;fi;local F="${A[0]}";local G=$(find "$j/projects/$F" -name "*.tar.gz" -type f 2>/dev/null | sort -r | head -1);if [ -n "$G" ];then echo "";echo -e "${s}–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞ –ø—Ä–æ–µ–∫—Ç–∞: $F${x}"
cj "$G";fi;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
2) if [ ${#A[@]} -eq 0 ];then echo -e "${p}–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è${x}";read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";continue;fi;echo "";echo -e "${s}–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:${x}";echo "";local H=1;for I in "${A[@]}";do printf "  %2d) %s\n" "$H" "$I";H=$((H + 1));done
echo "";read -p "–í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç [1-${#A[@]}]: " J;if echo "$J" | grep -q '^[0-9]\+$' && [ $J -ge 1 ] && [ $J -le ${#A[@]} ];then local K=$((J - 1));local L="${A[$K]}";local M=$(cg "$L");if [ -n "$M" ] && [ -f "$M" ];then cj "$M";fi;fi;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
3) echo "";echo -e "${s}–†—É—á–Ω–æ–π –≤—ã–±–æ—Ä –±—ç–∫–∞–ø–∞${x}";echo "";local N=$(cg);if [ -n "$N" ] && [ -f "$N" ];then cj "$N";else echo -e "${p}–ë—ç–∫–∞–ø –Ω–µ –≤—ã–±—Ä–∞–Ω${x}";fi;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
4) echo "";echo -e "${s}=== –í–°–ï –î–û–°–¢–£–ü–ù–´–ï –ë–≠–ö–ê–ü–´ ===${x}";echo "";local O=($(ce));if [ ${#O[@]} -eq 0 ];then echo -e "${p}–ë—ç–∫–∞–ø—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã${x}";else local P=1;for Q in "${O[@]}";do local R=$(cf "$Q");IFS='|' read -r S T U V W <<< "$R"
local X=$(basename "$Q");local Y=$(aA "$Q");local Z=$(aB "$Y");local a0="$U";[ -z "$a0" ] && a0=$(stat -c "%y" "$Q" 2>/dev/null | cut -d' ' -f1);printf " %2d) %-30s | üìÅ %2s | üóÑÔ∏è  %2s | %-10s | %s\n" "$P" "$S" "$V" "$W" "$Z" "$a0";P=$((P + 1));done;fi;echo ""
read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
0) return ;;
*) echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!${x}";sleep 1 ;;esac;done;}
cl(){ echo "";echo -e "${s}=== –ü–û–°–õ–ï–î–ù–ò–ô –û–¢–ß–ï–¢ –û –ë–≠–ö–ê–ü–ï ===${x}";echo "";if [ ! -f "$k" ];then echo -e "${p}–õ–æ–≥ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω${x}";return 1;fi;local A=$(grep -n "–ù–∞—á–∏–Ω–∞–µ–º –±—ç–∫–∞–ø" "$k" | tail -1 | cut -d: -f1)
if [ -z "$A" ];then echo -e "${p}–ó–∞–ø–∏—Å–µ–π –æ –±—ç–∫–∞–ø–∞—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω–æ${x}";return 1;fi;tail -n +$A "$k" | grep -A 50 "–ù–∞—á–∏–Ω–∞–µ–º –±—ç–∫–∞–ø" | head -100;echo "";echo -e "${o}‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê${x}";echo "";local B=$(grep -c "‚úì –ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–±—ç–∫–∞–ø–ª–µ–Ω" "$k" | tail -1)
local C=$(grep -c "‚úó –û—à–∏–±–∫–∞ –±—ç–∫–∞–ø–∞ –ø—Ä–æ–µ–∫—Ç–∞" "$k" | tail -1);echo -e "${s}–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –±—ç–∫–∞–ø–∞:${x}";echo "‚úÖ –£—Å–ø–µ—à–Ω–æ: $B –ø—Ä–æ–µ–∫—Ç–æ–≤";echo "‚ùå –û—à–∏–±–∫–∏: $C –ø—Ä–æ–µ–∫—Ç–æ–≤";if [ $C -gt 0 ];then echo "";echo -e "${p}–û—à–∏–±–∫–∏:${x}";grep "‚úó –û—à–∏–±–∫–∞ –±—ç–∫–∞–ø–∞ –ø—Ä–æ–µ–∫—Ç–∞" "$k" | tail -5;fi;}
cm(){ while true;do clear;echo -e "${o}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${x}";echo -e "${o}‚ïë                    –û–°–ù–û–í–ù–´–ï –ù–ê–°–¢–†–û–ô–ö–ò                    ‚ïë${x}"
echo -e "${o}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${x}";echo "";echo -e "${s}–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:${x}";echo "  1) –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –±—ç–∫–∞–ø–æ–≤: $j";echo "  2) –î–Ω–µ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è –±—ç–∫–∞–ø–æ–≤: $l";echo "";echo -e "${p}  0) –ù–∞–∑–∞–¥${x}";echo ""
read -p "–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è [0-2]: " A;case $A in 1) read -p "–ù–æ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è –±—ç–∫–∞–ø–æ–≤ [$j]: " B;if [ -n "$B" ];then j="$B";k="$j/backup.log";mkdir -p "$j";echo -e "${o}‚úì –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞${x}";bH;fi ;;
2) read -p "–î–Ω–µ–π —Ö—Ä–∞–Ω–µ–Ω–∏—è –±—ç–∫–∞–ø–æ–≤ [$l]: " C;if [ -n "$C" ] && echo "$C" | grep -q '^[0-9]\+$';then l="$C";echo -e "${o}‚úì –°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω${x}";bH;else echo -e "${n}‚úó –ù–µ–≤–µ—Ä–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ${x}";fi ;;
0) return ;;
*) echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!${x}";sleep 1 ;;esac;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";done;}
cn(){ while true;do clear;echo -e "${o}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${x}";echo -e "${o}‚ïë               –ù–ê–°–¢–†–û–ô–ö–ê TELEGRAM                        ‚ïë${x}"
echo -e "${o}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${x}";echo "";if [ "$Y" = "true" ];then echo -e "${o}‚úì Telegram –≤–∫–ª—é—á–µ–Ω${x}";else echo -e "${n}‚úó Telegram –≤—ã–∫–ª—é—á–µ–Ω${x}";fi;echo "";echo -e "${s}–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:${x}"
echo "  1) Bot Token: $(echo "$Z" | cut -c1-10)...";echo "  2) Chat ID: $aa";echo "  3) Thread ID: $ab";echo "  4) –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–∞–π–ª—ã: $ac";echo "  5) –ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: ${ad}MB";echo "  6) –£–≤–µ–¥–æ–º–ª—è—Ç—å –æ–± —É—Å–ø–µ—Ö–µ: $ae";echo "  7) –£–≤–µ–¥–æ–º–ª—è—Ç—å –æ–± –æ—à–∏–±–∫–∞—Ö: $af"
echo "  8) –°–∂–∏–º–∞—Ç—å –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π: $ag";echo "  9) –†–µ–∂–∏–º —Ä–∞–∑–º–µ—Ç–∫–∏: $ah";echo "  10) –ú–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–æ–≤: $ai";echo "";echo -e "${q}–î–µ–π—Å—Ç–≤–∏—è:${x}";echo "";echo "  11) –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å Telegram";echo "  12) –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è"
echo "  13) –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞";echo "  14) –î–µ—Ç–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Telegram";echo -e "${p}  0) –ù–∞–∑–∞–¥${x}";echo "";read -p "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ [0-14]: " A;case $A in 1) read -p "Bot Token: " B;if [ -n "$B" ];then Z="$B";bI;echo -e "${o}‚úì Token —Å–æ—Ö—Ä–∞–Ω–µ–Ω${x}";fi ;;
2) read -p "Chat ID: " C;if [ -n "$C" ];then aa="$C";bI;echo -e "${o}‚úì Chat ID —Å–æ—Ö—Ä–∞–Ω–µ–Ω${x}";fi ;;
3) read -p "Thread ID (–æ—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –µ—Å–ª–∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è): " D;ab="$D";bI;echo -e "${o}‚úì Thread ID —Å–æ—Ö—Ä–∞–Ω–µ–Ω${x}";;
4) if [ "$ac" = "true" ];then ac="false";else ac="true";fi;bI;echo -e "${o}‚úì –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤: $ac${x}";;
5) read -p "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (MB) [$ad]: " E;if [ -n "$E" ] && echo "$E" | grep -q '^[0-9]\+$';then ad="$E";bI;echo -e "${o}‚úì –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –∏–∑–º–µ–Ω–µ–Ω${x}";fi ;;
6) if [ "$ae" = "true" ];then ae="false";else ae="true";fi;bI;echo -e "${o}‚úì –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ: $ae${x}";;
7) if [ "$af" = "true" ];then af="false";else af="true";fi;bI;echo -e "${o}‚úì –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö: $af${x}";;
8) if [ "$ag" = "true" ];then ag="false";else ag="true";fi;bI;echo -e "${o}‚úì –°–∂–∞—Ç–∏–µ —Ñ–∞–π–ª–æ–≤: $ag${x}";;
9) echo "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–∑–º–µ—Ç–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è HTML):";echo "  1) HTML (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)";echo "  2) MarkdownV2";echo "  3) –û—Ç–∫–ª—é—á–∏—Ç—å —Ä–∞–∑–º–µ—Ç–∫—É";read -p "–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º [1-3]: " F;case $F in 1) ah="HTML" ;;2) ah="MarkdownV2" ;;3) ah="" ;;*) echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä${x}" ;;esac
bI;echo -e "${o}‚úì –†–µ–∂–∏–º —Ä–∞–∑–º–µ—Ç–∫–∏ –∏–∑–º–µ–Ω–µ–Ω: $ah${x}";;
10) echo "–ú–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–æ–≤ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω –∫–∞–∫ 'combined' (–∞—Ä—Ö–∏–≤–æ–º)";echo -e "${o}‚úì –ú–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏: –∞—Ä—Ö–∏–≤–æ–º (combined)${x}";;
11) if [ "$Y" = "true" ];then Y="false";echo -e "${p}‚ö† Telegram –≤—ã–∫–ª—é—á–µ–Ω${x}";else if [ -n "$Z" ] && [ -n "$aa" ];then Y="true";echo -e "${o}‚úì Telegram –≤–∫–ª—é—á–µ–Ω${x}";else echo -e "${n}‚úó –°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ Bot Token –∏ Chat ID${x}";fi;fi;bI ;;
12) echo "";echo -e "${s}=== –¢–ï–°–¢–û–í–ê–Ø –û–¢–ü–†–ê–í–ö–ê –í TELEGRAM ===${x}";if [ "$Y" != "true" ];then echo -e "${n}Telegram –Ω–µ –≤–∫–ª—é—á–µ–Ω${x}";else local G=$(date '+%Y-%m-%d %H:%M:%S');local H=$(hostname 2>/dev/null || echo "unknown")
local I="<b>–¢–ï–°–¢–û–í–û–ï –°–û–û–ë–©–ï–ù–ò–ï</b>";I="${I}"$'\n'"";I="${I}"$'\n'"<b>–•–æ—Å—Ç:</b> <code>$H</code>";I="${I}"$'\n'"<b>–í—Ä–µ–º—è:</b> <code>$G</code>";I="${I}"$'\n'"<b>–°—Ç–∞—Ç—É—Å:</b> ‚úÖ <b>–¢–ï–°–¢ –ü–†–û–ô–î–ï–ù</b>";I="${I}"$'\n'"<b>–ú–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏:</b> $ai"
echo -e "${q}–û—Ç–ø—Ä–∞–≤–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ HTML —Å–æ–æ–±—â–µ–Ω–∏—è...${x}";if aW "$I";then echo -e "${o}‚úì –¢–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ${x}";else echo -e "${n}‚úó –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è${x}";fi;fi ;;
13) ba ;;
14) co ;;
0) return ;;
*) echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!${x}" ;;esac;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";done;}
co(){ if [ "$Y" != "true" ] || [ -z "$Z" ] || [ -z "$aa" ];then echo -e "${n}Telegram –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏–ª–∏ –æ—Ç–∫–ª—é—á–µ–Ω${x}";echo "Y=$Y";echo "Z –¥–ª–∏–Ω–∞=${#Z}";echo "aa=$aa";return 1;fi;echo -e "${s}=== –î–ï–¢–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê TELEGRAM ===${x}"
echo -e "${q}1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Telegram:${x}";echo "   Bot Token: $(echo "$Z" | cut -c1-10)...";echo "   Chat ID: $aa";echo "   Thread ID: $ab";echo "   Max file size: ${ad}MB";echo -e "${q}2. –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–æ—Å—Ç–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è:${x}"
local A=$(date '+%Y-%m-%d %H:%M:%S');local B=$(hostname 2>/dev/null || echo "unknown");local C="<b>–¢–ï–°–¢–û–í–û–ï –°–û–û–ë–©–ï–ù–ò–ï</b>";C="${C}"$'\n'"";C="${C}"$'\n'"<b>–•–æ—Å—Ç:</b> <code>$B</code>";C="${C}"$'\n'"<b>–í—Ä–µ–º—è:</b> <code>$A</code>";C="${C}"$'\n'"<b>–¢–µ—Å—Ç:</b> –ü—Ä–æ—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ"
if aW "$C";then echo -e "   ${o}‚úì –ü—Ä–æ—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ${x}";else echo -e "   ${n}‚úó –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–æ—Å—Ç–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è${x}";return 1;fi;echo -e "${q}3. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞:${x}";local D="/tmp/telegram_detailed_test_$(date +%s).txt"
{ echo "–î–ï–¢–ê–õ–¨–ù–´–ô –¢–ï–°–¢–û–í–´–ô –§–ê–ô–õ –î–õ–Ø –ü–†–û–í–ï–†–ö–ò TELEGRAM –ë–û–¢–ê";echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê";echo "–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: $A";echo "–•–æ—Å—Ç: $B";echo "–°–∫—Ä–∏–ø—Ç: Backup Rebel";echo "–í–µ—Ä—Å–∏—è: 1.0";echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"
echo "";echo "–≠—Ç–æ –¥–µ—Ç–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã Telegram –±–æ—Ç–∞.";echo "–ï—Å–ª–∏ –≤—ã –ø–æ–ª—É—á–∏–ª–∏ —ç—Ç–æ—Ç —Ñ–∞–π–ª, –∑–Ω–∞—á–∏—Ç –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.";echo "";echo "–ù–∞—Å—Ç—Ä–æ–π–∫–∏ Telegram:";echo "  ‚Ä¢ –ú–µ—Ç–æ–¥ –æ—Ç–ø—Ä–∞–≤–∫–∏: $ai";echo "  ‚Ä¢ –ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: ${ad}MB"
echo "  ‚Ä¢ –°–∂–∞—Ç–∏–µ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π: $ag";echo "  ‚Ä¢ –†–∞–∑–º–µ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π: $ah";echo "  ‚Ä¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ: $ae";echo "  ‚Ä¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö: $af";echo "";echo "‚úÖ –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù –£–°–ü–ï–®–ù–û";echo "";echo "–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏."
echo "–†–∞–∑–º–µ—Ä —ç—Ç–æ–≥–æ —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–±–æ–ª—å—à–∏–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.";} > "$D";local E=$(aA "$D");echo "   ${o}‚úì –¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω: $D ($(aB "$E"))${x}";echo -e "${q}4. –¢–µ—Å—Ç –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–∞ —Å HTML –∑–∞–≥–æ–ª–æ–≤–∫–æ–º:${x}";local F="<b>üìã –î–ï–¢–ê–õ–¨–ù–ê–Ø –¢–ï–°–¢–û–í–ê–Ø –û–¢–ü–†–ê–í–ö–ê –§–ê–ô–õ–ê</b>"
F="${F}"$'\n'"";F="${F}"$'\n'"<b>–•–æ—Å—Ç:</b> <code>$B</code>";F="${F}"$'\n'"<b>–í—Ä–µ–º—è:</b> <code>$A</code>";F="${F}"$'\n'"<b>–°—Ç–∞—Ç—É—Å:</b> ‚úÖ <b>–¢–ï–°–¢ –û–¢–ü–†–ê–í–ö–ò –§–ê–ô–õ–ê</b>";F="${F}"$'\n'"";F="${F}"$'\n'"<i>–≠—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã Telegram –±–æ—Ç–∞</i>"
F="${F}"$'\n'"<i>–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: $(aB "$E")</i>";echo "   –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞...";if aX "$D" "$F";then echo -e "   ${o}‚úì –§–∞–π–ª –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω —É—Å–ø–µ—à–Ω–æ${x}";local G="<b>‚úÖ –î–ï–¢–ê–õ–¨–ù–´–ô –¢–ï–°–¢ –ó–ê–í–ï–†–®–ï–ù</b>";G="${G}"$'\n'"";G="${G}"$'\n'"<b>–•–æ—Å—Ç:</b> <code>$B</code>"
G="${G}"$'\n'"<b>–í—Ä–µ–º—è:</b> <code>$A</code>";G="${G}"$'\n'"<b>–°—Ç–∞—Ç—É—Å:</b> ‚úÖ <b>–í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´ –£–°–ü–ï–®–ù–û</b>";G="${G}"$'\n'"";G="${G}"$'\n'"<i>–¢–µ—Å—Ç –≤–∫–ª—é—á–∞–µ—Ç: –ø—Ä–æ—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ + –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–∞–π–ª–∞</i>";aW "$G";else echo -e "   ${n}‚úó –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–∞${x}"
echo -e "   ${p}–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:${x}";echo -e "     1. –¢–æ–∫–µ–Ω –±–æ—Ç–∞";echo -e "     2. Chat ID";echo -e "     3. –ü—Ä–∞–≤–∞ –±–æ—Ç–∞ –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É —Ñ–∞–π–ª–æ–≤";echo -e "     4. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤";local H="<b>‚ùå –î–ï–¢–ê–õ–¨–ù–´–ô –¢–ï–°–¢ –ù–ï –ü–†–û–ô–î–ï–ù</b>";H="${H}"$'\n'""
H="${H}"$'\n'"<b>–•–æ—Å—Ç:</b> <code>$B</code>";H="${H}"$'\n'"<b>–í—Ä–µ–º—è:</b> <code>$A</code>";H="${H}"$'\n'"<b>–°—Ç–∞—Ç—É—Å:</b> ‚ùå <b>–û–®–ò–ë–ö–ê –û–¢–ü–†–ê–í–ö–ò –§–ê–ô–õ–ê</b>";H="${H}"$'\n'"";H="${H}"$'\n'"<i>–ü—Ä–æ—Å—Ç–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞ –Ω–µ —É–¥–∞–ª–∞—Å—å</i>";aW "$H";fi
rm -f "$D";echo -e "${q}5. –û—á–∏—Å—Ç–∫–∞:${x}";echo "   ${o}‚úì –¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —É–¥–∞–ª–µ–Ω${x}";echo "";echo -e "${o}=== –î–ï–¢–ê–õ–¨–ù–´–ô –¢–ï–°–¢ –ó–ê–í–ï–†–®–ï–ù ===${x}";}
cp(){ local A=($(bg));if [ ${#A[@]} -eq 0 ];then echo -e "${p}–ù–µ—Ç –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–ª—è –±—ç–∫–∞–ø–∞${x}";read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";return 1;fi;echo "";echo -e "${s}=== –í–´–ë–û–† –ü–†–û–ï–ö–¢–û–í –î–õ–Ø –ë–≠–ö–ê–ü–ê ===${x}";echo "";local B=()
while true;do clear;echo -e "${o}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${x}";echo -e "${o}‚ïë           –í–´–ë–û–† –ü–†–û–ï–ö–¢–û–í –î–õ–Ø –ë–≠–ö–ê–ü–ê                     ‚ïë${x}"
echo -e "${o}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${x}";echo "";local C=1;for D in "${A[@]}";do local E=$(bf "$D");local F=$(bn "$D");local G=$(bo "$D");local H=$(bp "$D" && echo "true" || echo "false")
local I=$(bt "$D");local J=" ";if [[ " ${B[@]} " =~ " ${D} " ]];then J="‚úì";fi;local K="";if [ "$H" = "true" ];then K="${o}–≤–∫–ª${x}";else K="${n}–≤—ã–∫–ª${x}";fi;local L="";if [ -n "$I" ];then if bu "$D";then L="${o}‚è≤Ô∏è ${x}";else L="${n}‚è≤Ô∏è ${x}";fi;else L="${p}‚è≤Ô∏è ${x}";fi
printf " [%1s] %2d) %-25s üìÅ %2d | üóÑÔ∏è  %2d | %s | %s\n" "$J" "$C" "$E" "$F" "$G" "$K" "$L";C=$((C + 1));done;echo "";echo -e "${q}–î–µ–π—Å—Ç–≤–∏—è:${x}";echo "  [–Ω–æ–º–µ—Ä] - –≤—ã–±—Ä–∞—Ç—å/–æ—Ç–º–µ–Ω–∏—Ç—å –ø—Ä–æ–µ–∫—Ç";echo "  a - –≤—ã–±—Ä–∞—Ç—å –≤—Å–µ";echo "  c - –æ—á–∏—Å—Ç–∏—Ç—å –≤—ã–±–æ—Ä";echo "  s - –Ω–∞—á–∞—Ç—å –±—ç–∫–∞–ø"
echo "  q - –æ—Ç–º–µ–Ω–∞";echo "";read -p "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ: " M;case $M in [0-9]*) if echo "$M" | grep -q '^[0-9]\+$' && [ $M -ge 1 ] && [ $M -le ${#A[@]} ];then local N=$((M-1));local O="${A[$N]}";if [[ " ${B[@]} " =~ " ${O} " ]];then B=("${B[@]/$O}")
else B+=("$O");fi;fi ;;a|A) B=("${A[@]}") ;;c|C) B=() ;;s|S) if [ ${#B[@]} -eq 0 ];then echo -e "${n}–ù–µ –≤—ã–±—Ä–∞–Ω–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞${x}";sleep 1;continue;fi;break ;;q|Q) echo "–û—Ç–º–µ–Ω–∞";return 1 ;;esac;done
ax "INFO" "–ù–∞—á–∏–Ω–∞–µ–º –±—ç–∫–∞–ø ${#B[@]} –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤";local P=0;local Q=0;local R=();local S=$(date +%s);for T in "${B[@]}";do local U=$(bf "$T");ax "PROJECT" "–ë—ç–∫–∞–ø –ø—Ä–æ–µ–∫—Ç–∞: $U";local V;if V=$(ca "$T" "$U");then ax "SUCCESS" "‚úì –ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–±—ç–∫–∞–ø–ª–µ–Ω: $U"
R+=("$V");P=$((P + 1));else ax "ERROR" "‚úó –û—à–∏–±–∫–∞ –±—ç–∫–∞–ø–∞ –ø—Ä–æ–µ–∫—Ç–∞: $U";Q=$((Q + 1));fi;echo "";done;local W=$(date +%s);local X=$((W - S));local Y=$(tail -100 "$k" 2>/dev/null);if [ "$Y" = "true" ];then local Z=$(hostname 2>/dev/null || echo "unknown")
local a0=$(date '+%Y-%m-%d %H:%M:%S');local a1="<b>üìä –û–¢–ß–ï–¢ –û –ë–≠–ö–ê–ü–ï (–í–´–ë–†–ê–ù–ù–´–ï –ü–†–û–ï–ö–¢–´)</b>";a1="${a1}"$'\n'"";a1="${a1}"$'\n'"<b>–•–æ—Å—Ç:</b> <code>$Z</code>";a1="${a1}"$'\n'"<b>–î–∞—Ç–∞:</b> <code>$a0</code>";a1="${a1}"$'\n'"<b>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</b> $X —Å–µ–∫"
a1="${a1}"$'\n'"";a1="${a1}"$'\n'"<b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:</b>";a1="${a1}"$'\n'"‚úÖ <b>–£—Å–ø–µ—à–Ω–æ:</b> $P –ø—Ä–æ–µ–∫—Ç–æ–≤";a1="${a1}"$'\n'"‚ùå <b>–û—à–∏–±–∫–∏:</b> $Q –ø—Ä–æ–µ–∫—Ç–æ–≤";a1="${a1}"$'\n'"üìÅ <b>–í—ã–±—Ä–∞–Ω–æ:</b> ${#B[@]} –ø—Ä–æ–µ–∫—Ç–æ–≤";if [ ${#R[@]} -gt 0 ];then a1="${a1}"$'\n'""
a1="${a1}"$'\n'"<b>–°–æ–∑–¥–∞–Ω–Ω—ã–µ –∞—Ä—Ö–∏–≤—ã (${#R[@]}):</b>";for a2 in "${R[@]}";do local a3=$(basename "$a2");local a4=$(aA "$a2");local a5=$(aB "$a4");a1="${a1}"$'\n'"‚Ä¢ <code>$a3</code> ($a5)";done;fi;if [ $Q -eq 0 ] && [ $P -gt 0 ];then a1="${a1}"$'\n'""
a1="${a1}"$'\n'"<b>–°—Ç–∞—Ç—É—Å:</b> ‚úÖ <b>–í–°–ï –ü–†–û–ï–ö–¢–´ –£–°–ü–ï–®–ù–û –ó–ê–ë–≠–ö–ê–ü–õ–ï–ù–´</b>";else a1="${a1}"$'\n'"";a1="${a1}"$'\n'"<b>–°—Ç–∞—Ç—É—Å:</b> ‚ö†Ô∏è  <b>–ù–ï–ö–û–¢–û–†–´–ï –ü–†–û–ï–ö–¢–´ –ù–ï –ó–ê–ë–≠–ö–ê–ü–õ–ï–ù–´</b>";fi;aW "$a1";if [ "$ac" = "true" ] && [ ${#R[@]} -gt 0 ];then ax "TELEGRAM" "–û—Ç–ø—Ä–∞–≤–∫–∞ ${#R[@]} —Ñ–∞–π–ª–æ–≤ –±—ç–∫–∞–ø–æ–≤ –≤ Telegram"
ax "DEBUG" "–°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏:";for a6 in "${!R[@]}";do local a7="${R[$a6]}";if [ -f "$a7" ];then local a8=$(aA "$a7");local a9=$(aB "$a8");ax "DEBUG" "  [$a6] $a7 ($a9) - –°–£–©–ï–°–¢–í–£–ï–¢";else ax "DEBUG" "  [$a6] $a7 - –ù–ï –ù–ê–ô–î–ï–ù";fi;done;local ba=()
for bb in "${R[@]}";do if [ -f "$bb" ];then ba+=("$bb");local bc=$(aA "$bb");local bd=$(aB "$bc");ax "DEBUG" "–î–æ–±–∞–≤–ª—è–µ–º —Ñ–∞–π–ª –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏: $bb ($bd)";else ax "ERROR" "–§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: $bb";fi;done;if [ ${#ba[@]} -gt 0 ];then aZ "${ba[@]}"
else ax "ERROR" "–ù–µ—Ç –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram";fi;fi;if [ $Q -gt 0 ] && [ "$ac" = "true" ];then local be="/tmp/backup_log_$(date +%s).txt";echo "$Y" > "$be";aX "$be" "–õ–æ–≥ –æ—à–∏–±–æ–∫ –±—ç–∫–∞–ø–∞";rm -f "$be";fi;fi
if [ "$aj" = "true" ] && [ "$ar" = "true" ];then aU "$P" "$Q" "0" "${#B[@]}" "${R[@]}" "$X";fi;echo "";echo -e "${o}–ë—ç–∫–∞–ø –∑–∞–≤–µ—Ä—à–µ–Ω!${x}";echo "–£—Å–ø–µ—à–Ω–æ: $P –ø—Ä–æ–µ–∫—Ç–æ–≤";echo "–û—à–∏–±–∫–∏: $Q –ø—Ä–æ–µ–∫—Ç–æ–≤";echo "";read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";return $Q;}
cq(){ while true;do clear;echo -e "${o}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${x}";echo -e "${o}‚ïë                 –ù–ê–°–¢–†–û–ô–ö–ê EMAIL                         ‚ïë${x}"
echo -e "${o}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${x}";echo "";if [ "$aj" = "true" ];then echo -e "${o}‚úì Email –≤–∫–ª—é—á–µ–Ω${x}";else echo -e "${n}‚úó Email –≤—ã–∫–ª—é—á–µ–Ω${x}";fi;echo "";echo -e "${s}–¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:${x}"
echo "  1) SMTP —Å–µ—Ä–≤–µ—Ä: $ak:$al";echo "  2) SMTP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: $am";echo "  3) SMTP –ø–∞—Ä–æ–ª—å: $(if [ -n "$an" ];then echo "******";else echo "–Ω–µ –∑–∞–¥–∞–Ω";fi)";echo "  4) –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å (From): $ao";echo "  5) –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ (To): $ap";echo "  6) –ü—Ä–µ—Ñ–∏–∫—Å —Ç–µ–º—ã: $aq"
echo "  7) –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç—á–µ—Ç—ã: $ar";echo "  8) –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–∞–π–ª—ã: $as";echo "  9) –ú–∞–∫—Å. —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞: ${at}MB";echo "  10) –°–∂–∏–º–∞—Ç—å –≤–ª–æ–∂–µ–Ω–∏—è: $au";echo "  11) –£–≤–µ–¥–æ–º–ª—è—Ç—å –æ–± —É—Å–ø–µ—Ö–µ: $av";echo "  12) –£–≤–µ–¥–æ–º–ª—è—Ç—å –æ–± –æ—à–∏–±–∫–∞—Ö: $aw";echo "";echo -e "${q}–î–µ–π—Å—Ç–≤–∏—è:${x}";echo ""
echo "  13) –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å Email";echo "  14) –¢–µ—Å—Ç–æ–≤–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ email";echo -e "${p}  0) –ù–∞–∑–∞–¥${x}";echo "";read -p "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ [0-14]: " A;case $A in 1) read -p "SMTP —Å–µ—Ä–≤–µ—Ä [$ak]: " B;if [ -n "$B" ];then ak="$B";fi
read -p "SMTP –ø–æ—Ä—Ç [$al]: " C;if [ -n "$C" ];then al="$C";fi;aN;echo -e "${o}‚úì SMTP –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã${x}" ;;
2) read -p "SMTP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å [$am]: " D;if [ -n "$D" ];then am="$D";aN;echo -e "${o}‚úì SMTP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω${x}";fi ;;
3) read -sp "SMTP –ø–∞—Ä–æ–ª—å: " E;echo "";if [ -n "$E" ];then an="$E";aN;echo -e "${o}‚úì SMTP –ø–∞—Ä–æ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω${x}";fi ;;
4) read -p "–û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å (From) [$ao]: " F;if [ -n "$F" ];then ao="$F";aN;echo -e "${o}‚úì –û—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω${x}";fi ;;
5) read -p "–ü–æ–ª—É—á–∞—Ç–µ–ª–∏ (To, —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é) [$ap]: " G;if [ -n "$G" ];then ap="$G";aN;echo -e "${o}‚úì –ü–æ–ª—É—á–∞—Ç–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã${x}";fi ;;
6) read -p "–ü—Ä–µ—Ñ–∏–∫—Å —Ç–µ–º—ã [$aq]: " H;if [ -n "$H" ];then aq="$H";aN;echo -e "${o}‚úì –ü—Ä–µ—Ñ–∏–∫—Å —Ç–µ–º—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω${x}";fi ;;
7) if [ "$ar" = "true" ];then ar="false";else ar="true";fi;aN;echo -e "${o}‚úì –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–æ–≤: $ar${x}" ;;
8) if [ "$as" = "true" ];then as="false";else as="true";fi;aN;echo -e "${o}‚úì –û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–æ–≤: $as${x}" ;;
9) read -p "–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ (MB) [$at]: " I;if [ -n "$I" ] && echo "$I" | grep -q '^[0-9]\+$';then at="$I";aN;echo -e "${o}‚úì –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –∏–∑–º–µ–Ω–µ–Ω${x}";fi ;;
10) if [ "$au" = "true" ];then au="false";else au="true";fi;aN;echo -e "${o}‚úì –°–∂–∞—Ç–∏–µ –≤–ª–æ–∂–µ–Ω–∏–π: $au${x}" ;;
11) if [ "$av" = "true" ];then av="false";else av="true";fi;aN;echo -e "${o}‚úì –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ: $av${x}" ;;
12) if [ "$aw" = "true" ];then aw="false";else aw="true";fi;aN;echo -e "${o}‚úì –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö: $aw${x}" ;;
13) if [ "$aj" = "true" ];then aj="false";echo -e "${p}‚ö† Email –≤—ã–∫–ª—é—á–µ–Ω${x}";else if [ -n "$am" ] && [ -n "$an" ] && [ -n "$ao" ] && [ -n "$ap" ];then aj="true";echo -e "${o}‚úì Email –≤–∫–ª—é—á–µ–Ω${x}";else echo -e "${n}‚úó –°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ SMTP –∏ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π${x}";fi;fi;aN ;;
14) aV ;;
0) return ;;
*) echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!${x}" ;;esac;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è...";done;}
cr(){ while true;do clear;echo -e "${o}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${x}";echo -e "${o}‚ïë   –£–ú–ù–´–ô –°–ö–†–ò–ü–¢ –ë–≠–ö–ê–ü–ê –ü–†–û–ï–ö–¢–û–í –° –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø–ú–ò          ‚ïë${x}"
echo -e "${o}‚ïë   –ü—Ä–æ–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ        ‚ïë${x}";echo -e "${o}‚ïë   –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –ë–≠–ö–ê–ü–´ –ü–û –†–ê–°–ü–ò–°–ê–ù–ò–Æ                   ‚ïë${x}";echo -e "${o}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${x}";echo ""
echo -e "${s}–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:${x}";local A=$(bh);echo "  üìÇ –ü—Ä–æ–µ–∫—Ç–æ–≤: $A";local B=0;local C=0;local D=0;local E=0;local F=($(bg));for G in "${F[@]}";do if bp "$G";then B=$((B + 1));C=$((C + $(bn "$G")));D=$((D + $(bo "$G")));fi
if [ -f "$m/$G.schedule" ] && [ -s "$m/$G.schedule" ];then E=$((E + 1));fi;done;echo "  ‚úÖ –í–∫–ª—é—á–µ–Ω–æ –ø—Ä–æ–µ–∫—Ç–æ–≤: $B";echo "  üìÅ –í—Å–µ–≥–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π: $C";echo "  üóÑÔ∏è  –í—Å–µ–≥–æ –ë–î: $D";echo "  ‚è≤Ô∏è  –ü—Ä–æ–µ–∫—Ç–æ–≤ —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º: $E"
if [ "$Y" = "true" ];then echo -e "  üì± Telegram: ${o}–í–ö–õ${x} (–º–µ—Ç–æ–¥: $ai)";else echo -e "  üì± Telegram: ${n}–í–´–ö–õ${x}";fi;if [ "$aj" = "true" ];then echo -e "  üìß Email: ${o}–í–ö–õ${x} (–ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π: $(echo "$ap" | tr ',' '\n' | wc -l))";else echo -e "  üìß Email: ${n}–í–´–ö–õ${x}";fi
local H=$(find "$j" -name "*_*.tar.gz" -type f 2>/dev/null | wc -l);echo -e "  üíæ –î–æ—Å—Ç—É–ø–Ω–æ –±—ç–∫–∞–ø–æ–≤: $H";echo "";echo -e "${q}‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê${x}";echo -e "${p}        –†–ï–ó–ï–†–í–ù–û–ï –ö–û–ü–ò–†–û–í–ê–ù–ò–ï${x}";echo -e "${q}‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê${x}";echo ""
echo "  1) –ë—ç–∫–∞–ø –≤—Å–µ—Ö –≤–∫–ª—é—á–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ + –æ—Ç—á–µ—Ç—ã";echo "  2) –ë—ç–∫–∞–ø –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ + –æ—Ç—á–µ—Ç—ã";echo "  3) –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –±—ç–∫–∞–ø—ã";echo "";echo -e "${q}‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê${x}"
echo -e "${p}        –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –ë–≠–ö–ê–ü–´${x}";echo -e "${q}‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê${x}";echo "";echo "  4) –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è–º–∏";echo "  5) –ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ cron –∑–∞–¥–∞–Ω–∏—è";echo "  6) –¢–µ—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é";echo ""
echo -e "${q}‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê${x}";echo -e "${p}        –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–ò–ï${x}";echo -e "${q}‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê${x}";echo "";echo "  7) –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏–∑ –±—ç–∫–∞–ø–æ–≤";echo ""
echo -e "${q}‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê${x}";echo -e "${p}        –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–ï–ö–¢–ê–ú–ò${x}";echo -e "${q}‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê${x}";echo "";echo "  8) –ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤";echo "  9) –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"
echo "  10) –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è";echo "  11) –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è";echo "";echo -e "${q}‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê${x}";echo -e "${p}        –°–õ–£–ñ–ï–ë–ù–´–ï${x}";echo -e "${q}‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê${x}";echo ""
echo "  12) –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç—á–µ—Ç";echo "  13) –ü–æ–∫–∞–∑–∞—Ç—å –ª–æ–≥–∏";echo -e "${n}  0) –í—ã—Ö–æ–¥${x}";echo "";read -p "–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ [0-13]: " I;case $I in 1) echo "–ë—ç–∫–∞–ø –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤...";cd;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
2) echo "–ë—ç–∫–∞–ø –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤...";cp;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
3) echo "–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤...";cc;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
4) echo "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è–º–∏...";bY ;;
5) echo "–¢–µ–∫—É—â–∏–µ cron –∑–∞–¥–∞–Ω–∏—è...";bD;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
6) echo "–¢–µ—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é...";bZ;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
7) echo "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤...";ck;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
8) bX ;;
9) cm ;;
10) cn ;;
11) cq ;;
12) echo "–ü–æ–∫–∞–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ—Ç—á–µ—Ç–∞...";cl;read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
13) echo "";echo -e "${s}–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥–µ:${x}";echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê";if [ -f "$k" ];then tail -30 "$k" 2>/dev/null || echo "–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ—á–∏—Ç–∞—Ç—å –ª–æ–≥ —Ñ–∞–π–ª";else echo "–õ–æ–≥ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω";fi
echo "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê";read -p "–ù–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..." ;;
0) echo "";echo -e "${o}–î–æ —Å–≤–∏–¥–∞–Ω–∏—è!${x}";echo "";exit 0 ;;
*) echo -e "${n}–ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä!${x}";sleep 1 ;;esac;done;}
cs(){ case "$1" in "--auto") echo "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤...";cd ;;"--backup-project") if [ -n "$2" ];then echo "–ë—ç–∫–∞–ø –ø—Ä–æ–µ–∫—Ç–∞ —Å ID: $2";cb "$2";else echo "–û—à–∏–±–∫–∞: –Ω–µ —É–∫–∞–∑–∞–Ω ID –ø—Ä–æ–µ–∫—Ç–∞";exit 1;fi ;;
"--discover-projects") bW ;;"--projects") bX ;;"--backup") echo "–ë—ç–∫–∞–ø –ø—Ä–æ–µ–∫—Ç–æ–≤...";cd ;;"--restore") echo "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤...";ck ;;"--schedule") echo "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è–º–∏...";bY ;;"--cron") echo "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ cron –∑–∞–¥–∞–Ω–∏–π...";bB ;;
"--help"|"-h") echo "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $0 [–ü–ê–†–ê–ú–ï–¢–†]";echo "";echo "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:";echo "  --auto              –ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤";echo "  --backup-project ID –ë—ç–∫–∞–ø –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ ID";echo "  --discover-projects –ê–≤—Ç–æ–ø–æ–∏—Å–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤ –≤ /opt"
echo "  --projects          –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏ —á–µ—Ä–µ–∑ –º–µ–Ω—é";echo "  --backup            –ó–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫–∞–ø –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤";echo "  --restore           –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤";echo "  --schedule          –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è–º–∏";echo "  --cron              –û–±–Ω–æ–≤–∏—Ç—å cron –∑–∞–¥–∞–Ω–∏—è"
echo "  --help, -h          –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç—É —Å–ø—Ä–∞–≤–∫—É";echo "";echo "–ü—Ä–∏–º–µ—Ä—ã:";echo "  $0 --discover-projects    # –ê–≤—Ç–æ–ø–æ–∏—Å–∫ –ø—Ä–æ–µ–∫—Ç–æ–≤";echo "  $0 --projects             # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞–º–∏";echo "  $0 --backup               # –ë—ç–∫–∞–ø –≤—Å–µ—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤"
echo "  $0 --restore              # –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–æ–≤";echo "  $0 --schedule             # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è–º–∏";echo "  $0 --cron                 # –û–±–Ω–æ–≤–∏—Ç—å cron –∑–∞–¥–∞–Ω–∏—è";echo "  $0 --backup-project proj_123456 # –ë—ç–∫–∞–ø –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞"
echo "";echo "–ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ —É–∫–∞–∑–∞–Ω—ã, –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é." ;;*) echo "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä: $1";echo "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ --help –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø—Ä–∞–≤–∫–∏";exit 1 ;;esac;}
ct(){ az;bG;if [ $# -gt 0 ];then cs "$@";else cr;fi;}
ct "$@"
